(this["webpackJsonpsurvey-editor"]=this["webpackJsonpsurvey-editor"]||[]).push([[0],{310:function(e,t,n){},312:function(e,t,n){},382:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(17),i=n.n(a),c=(n(310),n(7)),s=n(49),l=n.n(s),u=n(25),d=n(83),h=n(27),f=n(32),b=n(404),p=n(88),j=n(80),v=n(33),g=(n(312),n(28)),m=n.n(g),O={yes:!0,no:!1,TRUE:!0,FALSE:!1,true:!0,false:!1},x=function(e){return{survey:e||{type:"",typeParameters:[],row:{type:"",name:"data",label:{"English (en)":"[empty survey]"}},children:[],indentationLevel:0,rowIndex:-1},nodesToAnswers:new Map,evaluationResults:new Map,stackDepth:0,knownLiteralsWithoutDollarSign:O}},y=r.createContext({schema:new m.a({}),context:x(),language:"English (en)",languageCode:"en",languageName:"English",debug:!0,xlsForm:void 0,setContext:function(){},onChangeAnswer:function(){},onChangeCell:function(){},onMoveNode:function(){},onSpliceRows:function(){},onRemoveRowAndChildren:function(){}}),w=n(87),k=n(143),E=n(3),N=n(53),T=n(97);function S(e){return e&&Object(u.a)(e.keys()).find((function(t){var n;return null===e||void 0===e||null===(n=e.get(t))||void 0===n?void 0:n.error}))}function A(e,t){var n={};return t.forEach((function(t){n[t]=e})),n}var C=0;var L=["calculation","required","relevant","readonly","constraint"];function R(e,t){var n,r;if(!t)return!1;var o=null===(n=t.evaluationResults.get(e))||void 0===n||null===(r=n.get("relevant"))||void 0===r?void 0:r.result;return void 0===o||o}function I(e){return"begin_group"===e.type||"begin_repeat"===e.type}var _,D=r.createContext({node:(_=new Set(["English (en)"]),C+=1,Object.freeze({row:{type:"text",name:"empty_node_".concat(C),label:A("Empty node ".concat(C),_)},type:"text",typeParameters:[],children:[],indentationLevel:0,rowIndex:-2}))}),M=n(56),P=n(30),F=p.O.create({className:"recipe-toaster",position:P.a.TOP}),B=n(1);function U(){var e=Object(r.useContext)(y),t=Object(r.useState)(!1),n=Object(h.a)(t,2),o=n[0],a=n[1],i=Object(r.useState)(),c=Object(h.a)(i,2),s=c[0],l=c[1],u=s&&I(s),d=Object(r.useCallback)((function(){a(!1)}),[]),f=Object(r.useCallback)((function(){s&&(F.show({intent:"none",message:Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("code",{children:s.row.name})," field removed."]})}),e.onRemoveRowAndChildren(s),a(!1))}),[e,s]);return{showRemoveConfirmationDialog:Object(r.useCallback)((function(e){l(e),a(!0)}),[]),alert:Object(B.jsxs)(p.a,{cancelButtonText:"Cancel",confirmButtonText:"Delete",icon:"trash",intent:M.a.DANGER,isOpen:o,onCancel:d,onConfirm:f,canOutsideClickCancel:!0,canEscapeKeyCancel:!0,children:[Object(B.jsxs)("p",{children:["Are you sure you want to remove the ",Object(B.jsx)("code",{children:null===s||void 0===s?void 0:s.row.name})," ",u?"group":"field","?"]}),u&&(null===s||void 0===s?void 0:s.children.length)&&Object(B.jsx)("p",{children:"This will also remove the group\u2019s nested fields."})]})}}var G=n(37);function V(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.survey;if((null===(n=o.row)||void 0===n?void 0:n.name)===e)return o;if(null===(r=o.children)||void 0===r?void 0:r.length)for(var a=0;a<o.children.length;a+=1){var i,c=o.children[a];if((null===(i=c.row)||void 0===i?void 0:i.name)===e)return c;var s=V(e,t,c);if(s)return s}}function $(e,t,n){var r;if((null===(r=n.row)||void 0===r?void 0:r.name)===e)return n;if(n.children)for(var o=0;o<n.children.length;o+=1){var a,i=n.children[o];if((null===(a=i.row)||void 0===a?void 0:a.name)===e)return i}var c=Q(n,t),s=null===c||void 0===c?void 0:c[c.length-1];return s&&$(e,t,s)||void 0}function z(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.survey,a=e[0];if("."===a)r=o;else if("/"===a)r=t.survey;else if(".."===a){if(o===t.survey)throw new Error("Reached root - Can\u2019t traverse further up the hierarchy.");var i=Q(o,t);r=null===i||void 0===i?void 0:i[i.length-1]}else if(a===o.row.name)r=o;else if(null===(n=o.children)||void 0===n?void 0:n.length)for(var c=0;c<o.children.length;c+=1){var s=o.children[c];if(s.row.name===a){r=s;break}}return 1===e.length?r:z(e.slice(1),t,r)}function H(e,t){var n,r;if(!e)return["/"];if(!(null===e||void 0===e||null===(n=e.row)||void 0===n?void 0:n.name))throw new Error("Encountered a row without a name (row #".concat(e.rowIndex,"). This should not happen. Please ensure the survey data is valid."));var o=Q(e,t);return[null===(r=e.row)||void 0===r?void 0:r.name].concat(Object(u.a)(H(null===o||void 0===o?void 0:o[o.length-1],t)))}function K(e,t){var n;return null===(n=H(e,t))||void 0===n?void 0:n.reverse()}function W(e,t){return K(e,t).slice(1).join(".")}function q(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Object(G.isEqual)(e,t))return r;if(null===(n=t.children)||void 0===n?void 0:n.length)for(var o=0;o<t.children.length;o+=1){r.push(o);var a=t.children[o],i=q(e,a,r);if(void 0!==i)return i;r.pop()}}function X(e,t){return q(e,t.survey)}function J(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Object(G.isEqual)(e,t))return r;if(null===(n=t.children)||void 0===n?void 0:n.length){r.push(t);for(var o=0;o<t.children.length;o+=1){var a=t.children[o],i=J(e,a,r);if(i)return i}r.pop()}}function Q(e,t){return J(e,t.survey)}var Y,Z=n(16),ee=n(20),te=n(18),ne=n(19),re=n(159),oe=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(){var e;Object(Z.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).token=void 0,e}return Object(ee.a)(n,[{key:"toMarkdown",value:function(){return this.message}}]),n}(Object(re.a)(Error)),ae=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o,a,i){var c,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;Object(Z.a)(this,n),(c=t.call(this,e)).type=r,c.expression=o,c.context=a,c.scope=i,c.underlyingEvaluationError=s,c.nodeStack=void 0;var l=J(i,a.survey);return c.nodeStack=[].concat(Object(u.a)(l||[]),[i]),c}return Object(ee.a)(n,[{key:"toMarkdown",value:function(){return this.message}}]),n}(oe),ie=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o){var a;return Object(Z.a)(this,n),(a=t.call(this,r)).type=e,a.tokens=o,a}return Object(ee.a)(n,[{key:"toMarkdown",value:function(){return this.message}}]),n}(oe),ce=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r){var o;return Object(Z.a)(this,n),(o=t.call(this,r)).token=e,o.message=r,o}return n}(oe),se=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(){return Object(Z.a)(this,n),t.apply(this,arguments)}return n}(oe),le=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(){return Object(Z.a)(this,n),t.apply(this,arguments)}return n}(oe),ue=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e){return Object(Z.a)(this,n),t.call(this,"The `".concat(e,"` function is not supported yet. If you need it, please contact the developers."))}return n}(oe);!function(e){e[e.LEFT_PAREN=0]="LEFT_PAREN",e[e.RIGHT_PAREN=1]="RIGHT_PAREN",e[e.COMMA=2]="COMMA",e[e.ASSIGN=3]="ASSIGN",e[e.PLUS=4]="PLUS",e[e.MINUS=5]="MINUS",e[e.ASTERISK=6]="ASTERISK",e[e.DOLLAR=7]="DOLLAR",e[e.LEFT_BRACE=8]="LEFT_BRACE",e[e.RIGHT_BRACE=9]="RIGHT_BRACE",e[e.GREATER_THAN=10]="GREATER_THAN",e[e.LESS_THAN=11]="LESS_THAN",e[e.SLASH=12]="SLASH",e[e.POINT=13]="POINT",e[e.CARET=14]="CARET",e[e.TILDE=15]="TILDE",e[e.BANG=16]="BANG",e[e.BACKSLASH=17]="BACKSLASH",e[e.QUESTION=18]="QUESTION",e[e.COLON=19]="COLON",e[e.SINGLE_QUOTE=20]="SINGLE_QUOTE",e[e.DOUBLE_QUOTE=21]="DOUBLE_QUOTE",e[e.MODULO=22]="MODULO",e[e.BOOLEAN_AND=23]="BOOLEAN_AND",e[e.BOOLEAN_OR=24]="BOOLEAN_OR",e[e.COMPARISON=25]="COMPARISON",e[e.NAME=26]="NAME",e[e.LITERAL=27]="LITERAL",e[e.NUMBER_LITERAL=28]="NUMBER_LITERAL",e[e.FLOAT_LITERAL=29]="FLOAT_LITERAL",e[e.INT_LITERAL=30]="INT_LITERAL",e[e.STRING_LITERAL=31]="STRING_LITERAL",e[e.BOOLEAN_LITERAL=32]="BOOLEAN_LITERAL",e[e.SELECTOR=33]="SELECTOR",e[e.WHITESPACE=34]="WHITESPACE",e[e.UNKNOWN=35]="UNKNOWN",e[e.EOF=36]="EOF",e[e.INVALID=37]="INVALID",e[e.INTERNAL_LEXER_ERROR=38]="INTERNAL_LEXER_ERROR"}(Y||(Y={}));Y.LEFT_PAREN,Y.RIGHT_PAREN,Y.COMMA,Y.ASSIGN,Y.PLUS,Y.MINUS,Y.ASTERISK,Y.GREATER_THAN,Y.LESS_THAN,Y.BOOLEAN_AND,Y.BOOLEAN_OR,Y.SLASH,Y.CARET,Y.TILDE,Y.BANG,Y.MODULO,Y.COMPARISON,Y.BACKSLASH,Y.QUESTION,Y.COLON,Y.SINGLE_QUOTE,Y.DOUBLE_QUOTE,Y.NAME,Y.LITERAL,Y.NUMBER_LITERAL,Y.INT_LITERAL,Y.FLOAT_LITERAL,Y.STRING_LITERAL,Y.BOOLEAN_LITERAL,Y.WHITESPACE,Y.UNKNOWN,Y.EOF,Y.INVALID;function de(e){switch(e){case Y.LEFT_PAREN:return"(";case Y.RIGHT_PAREN:return")";case Y.COMMA:return",";case Y.ASSIGN:return"=";case Y.PLUS:return"+";case Y.MINUS:return"-";case Y.ASTERISK:return"*";case Y.SLASH:return"/";case Y.CARET:return"^";case Y.TILDE:return"~";case Y.BANG:return"!";case Y.BACKSLASH:return"\\";case Y.QUESTION:return"?";case Y.COLON:return":";default:return"[undefined punctuator]"}}var he=function e(){Object(Z.a)(this,e),this.kind=void 0,this.tokens=void 0,this.children=void 0},fe=[[Y.STRING_LITERAL,/^'(\\\\|\\'|[^'])*'/],[Y.STRING_LITERAL,/^"(\\\\|\\"|[^"])*"/],[Y.SLASH,/^div/],[Y.MODULO,/^mod/],[Y.BOOLEAN_AND,/^and/],[Y.BOOLEAN_OR,/^or/],[Y.FLOAT_LITERAL,/^-?\d+\.\d+/],[Y.INT_LITERAL,/^-?\d+/],[Y.NAME,/^\$?{[^}]+}/],[Y.NAME,/^[a-zA-Z_\w_][a-zA-Z_\w_-]*/],[Y.SELECTOR,/^\/(\/?[\w*]+(?:\[[^]+?]\B)?)/],[Y.LEFT_PAREN,/^\(/],[Y.RIGHT_PAREN,/^\)/],[Y.COMMA,/^,/],[Y.PLUS,/^\+/],[Y.MINUS,/^-/],[Y.ASTERISK,/^\*/],[Y.COMPARISON,/^(>=|>|<=|<|=|!=)/],[Y.COMPARISON,/^(>=|>|<=|<|=|!=)/],[Y.INVALID,/^(\w+|[\s\S])/]],be=function(){function e(t){Object(Z.a)(this,e),this.text=t,this.index=0}return Object(ee.a)(e,[{key:"next",value:function(){if(this.index>=this.text.length)return{value:{type:Y.EOF,text:"",index:this.index}};for(;" "===this.text[this.index];)this.index+=1;for(var e=0;e<fe.length;e+=1){var t=fe[e],n=Object(h.a)(t,2),r=n[0],o=n[1],a=this.text.slice(this.index).match(o);if(null!==a){var i=a[0],c={type:r,text:this.text.substr(this.index,i.length),index:this.index};return this.index+=i.length,{value:c}}}var s={type:Y.INTERNAL_LEXER_ERROR,text:this.text[this.index],index:this.index};throw new ce(s,"Lexer should never get here. If we get here, this means there is no invalid token defined at the end of the pattern list. This invalid token should match at least one character that is not recognized by all other patterns.")}}]),e}(),pe=function e(){Object(Z.a)(this,e)},je=function e(){Object(Z.a)(this,e)},ve=function(){function e(t){Object(Z.a)(this,e),this.options=t,this.readTokens=[],this.prefixParselets=new Map,this.infixParselets=new Map}return Object(ee.a)(e,[{key:"register",value:function(e,t){if(t instanceof je)this.prefixParselets.set(e,t);else{if(!(t instanceof pe))throw new Error("Found a parselet that was neither an infix nor a prefix parselet: No idea what to do with it\u2026");this.infixParselets.set(e,t)}}},{key:"parseExpression",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=this.consumeAnything();if(!r)throw new ie("prematureEOF","Parser encountered end of tokens. This should not happen.");var o=this.prefixParselets.get(r.type);if(!o)throw new ie("undefinedPrefix","Expected start of a new expression, but `".concat(r.text,"` is not an allowed prefix."),[r]);for(var a=o.parse(this,r);n<this.getPrecedence();){var i=this.consumeAnything();if(!i)throw new ie("prematureEndOfTokens","Parser encountered end of tokens. This should not happen.");var c=this.infixParselets.get(i.type);if(!c)throw new ie("undefinedInfix","`".concat(i.text,"` is not an allowed infix."),[i]);a=c.parse(this,a,i)}return null===(e=(t=this.options).onExpression)||void 0===e||e.call(t,a),a}},{key:"match",value:function(e){if(this.lookAhead(0).type===e)return this.consumeAnything()}},{key:"consume",value:function(e){var t=this.lookAhead(0);if(t.type!==e)throw new Error("Expected token "+e+" and found "+t.type);if(!this.consumeAnything())throw new Error("Could not consume token "+e);return t}},{key:"consumeAnything",value:function(){return this.lookAhead(0),this.readTokens.shift()}},{key:"lookAhead",value:function(e){for(;e>=this.readTokens.length;){var t,n,r=this.options.tokens.next();r.value&&(null===(t=(n=this.options).onToken)||void 0===t||t.call(n,r.value)),this.readTokens.push(r.value)}return this.readTokens[e]}},{key:"getPrecedence",value:function(){var e=this.infixParselets.get(this.lookAhead(0).type);return e?e.getPrecedence():0}}]),e}(),ge=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o){var a;return Object(Z.a)(this,n),(a=t.call(this)).tokens=e,a.name=r,a.text=o,a.kind="name",a.children=a.tokens,a}return Object(ee.a)(n,[{key:"print",value:function(e){e(this.name)}}]),n}(he),me=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o,a){var i;return Object(Z.a)(this,n),(i=t.call(this)).tokens=e,i.left=r,i.operatorToken=o,i.right=a,i.kind="operator",i.children=[i.left,i.operatorToken,i.right],i}return Object(ee.a)(n,[{key:"print",value:function(e){e("("),this.left.print(e),e(" "),e(this.operatorToken.text),e(" "),this.right.print(e),e(")")}}]),n}(he),Oe=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r){var o;return Object(Z.a)(this,n),(o=t.call(this)).precedence=e,o.isRight=r,o}return Object(ee.a)(n,[{key:"parse",value:function(e,t,n){var r=e.parseExpression(this.precedence-(this.isRight?1:0));return new me([].concat(Object(u.a)(t.tokens),[n],Object(u.a)(r.tokens)),t,n,r)}},{key:"getPrecedence",value:function(){return this.precedence}}]),n}(pe),xe=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o,a,i){var c;return Object(Z.a)(this,n),(c=t.call(this)).tokens=e,c.fn=r,c.leftParenToken=o,c.argsAndDelimiters=a,c.rightParenToken=i,c.kind="call",c.args=void 0,c.children=[c.fn,c.leftParenToken].concat(Object(u.a)(c.argsAndDelimiters),[c.rightParenToken]),c.args=a.filter((function(e){return e instanceof he})),c}return Object(ee.a)(n,[{key:"print",value:function(e){this.fn.print(e),e("(");for(var t=0;t<this.args.length;t++)this.args[t].print(e),t<this.args.length-1&&e(", ");e(")")}}]),n}(he),ye=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o){var a;return Object(Z.a)(this,n),(a=t.call(this)).rightParenTokenType=e,a.argumentDelimiterTokenType=r,a.precedence=o,a}return Object(ee.a)(n,[{key:"parse",value:function(e,t,n){var r=[],o=e.match(this.rightParenTokenType),a=[].concat(Object(u.a)(t.tokens),[n]),i=[];if(o)a.push(o);else{var c;do{var s=e.parseExpression();r.push(s),a.push.apply(a,Object(u.a)(s.tokens)),i.push(s),(c=e.match(this.argumentDelimiterTokenType))&&(a.push(c),i.push(c))}while(c);(o=e.consume(this.rightParenTokenType))&&a.push(o)}return new xe(a,t,n,i,o)}},{key:"getPrecedence",value:function(){return this.precedence}}]),n}(pe),we=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o,a,i,c){var s;return Object(Z.a)(this,n),(s=t.call(this)).tokens=e,s.condition=r,s.questionMarkToken=o,s.thenArm=a,s.colonToken=i,s.elseArm=c,s.kind="conditional",s.children=[s.condition,s.questionMarkToken,s.thenArm,s.colonToken,s.elseArm],s}return Object(ee.a)(n,[{key:"print",value:function(e){e("("),this.condition.print(e),e(" ? "),this.thenArm.print(e),e(" : "),this.elseArm.print(e),e(")")}}]),n}(he),ke=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e){var r;return Object(Z.a)(this,n),(r=t.call(this)).precedence=e,r}return Object(ee.a)(n,[{key:"parse",value:function(e,t,n){var r=e.parseExpression(),o=e.consume(Y.COLON),a=e.parseExpression(this.precedence-1);return new we([].concat(Object(u.a)(t.tokens),[n],Object(u.a)(r.tokens),[o],Object(u.a)(a.tokens)),t,n,r,o,a)}},{key:"getPrecedence",value:function(){return this.precedence}}]),n}(pe),Ee=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e){var r;return Object(Z.a)(this,n),(r=t.call(this)).rightParenTokenType=e,r}return Object(ee.a)(n,[{key:"parse",value:function(e,t){var n=e.parseExpression(),r=e.consume(this.rightParenTokenType);return n.tokens=[t].concat(Object(u.a)(n.tokens),[r]),n.children=[t,n,r],n}}]),n}(je),Ne=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return Object(Z.a)(this,n),(e=t.call(this)).getName=r,e}return Object(ee.a)(n,[{key:"parse",value:function(e,t){var n=this.getName(t.text);return new ge([t],n,t.text)}}]),n}(je),Te=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o){var a;return Object(Z.a)(this,n),(a=t.call(this)).tokens=e,a.left=r,a.operatorToken=o,a.kind="postfix",a.children=[a.left,a.operatorToken],a}return Object(ee.a)(n,[{key:"print",value:function(e){e("("),this.left.print(e),e(de(this.operatorToken.type)),e(")")}}]),n}(he),Se=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e){var r;return Object(Z.a)(this,n),(r=t.call(this)).precedence=e,r}return Object(ee.a)(n,[{key:"parse",value:function(e,t,n){return new Te([].concat(Object(u.a)(t.tokens),[n]),t,n)}},{key:"getPrecedence",value:function(){return this.precedence}}]),n}(pe),Ae=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o){var a;return Object(Z.a)(this,n),(a=t.call(this)).tokens=e,a.operatorToken=r,a.right=o,a.kind="prefix",a.children=[a.right],a}return Object(ee.a)(n,[{key:"print",value:function(e){e("("),e(de(this.operatorToken.type)),this.right.print(e),e(")")}}]),n}(he),Ce=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e){var r;return Object(Z.a)(this,n),(r=t.call(this)).precedence=e,r}return Object(ee.a)(n,[{key:"parse",value:function(e,t){var n=e.parseExpression(this.precedence);return new Ae([t].concat(Object(u.a)(n.tokens)),t,n)}},{key:"getPrecedence",value:function(){return this.precedence}}]),n}(je),Le=ve,Re=function e(){Object(Z.a)(this,e)};Re.BOOLEAN_OP=1,Re.CONDITIONAL=2,Re.ASSIGNMENT=3,Re.SUM=4,Re.PRODUCT=5,Re.EXPONENT=6,Re.PREFIX=7,Re.POSTFIX=8,Re.CALL=9;var Ie=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r,o){var a;return Object(Z.a)(this,n),(a=t.call(this)).tokens=e,a.type=r,a.value=o,a.kind="literal",a.children=a.tokens,a}return Object(ee.a)(n,[{key:"print",value:function(e){"string"!==this.type?(e("["),e(this.type),e(" "),e(String(this.value)),e("]")):e("'".concat(this.value,"'"))}}]),n}(he),_e=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r){var o;return Object(Z.a)(this,n),(o=t.call(this)).getValue=e,o.getType=r,o}return Object(ee.a)(n,[{key:"parse",value:function(e,t){var n=this.getValue(t),r=this.getType(t);return new Ie([t],r,n)}}]),n}(je),De=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e,r){var o;return Object(Z.a)(this,n),(o=t.call(this)).selectorToken=e,o.selector=r,o.kind="selector",o.children=[o.selectorToken],o.tokens=[o.selectorToken],o}return Object(ee.a)(n,[{key:"print",value:function(e){e(this.selectorToken.text)}}]),n}(he),Me=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e){var r;return Object(Z.a)(this,n),(r=t.call(this)).getSelector=e,r}return Object(ee.a)(n,[{key:"parse",value:function(e,t){var n=this.getSelector(t.text);return new De(t,n)}}]),n}(je),Pe=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e){var r;return Object(Z.a)(this,n),(r=t.call(this,Object(c.a)({onExpression:function(e){return r.expressions.push(e)},onToken:function(e){return r.tokens.push(e)}},e))).expressions=[],r.tokens=[],r.register(Y.NAME,new Ne((function(e){return e.startsWith("$")?e.slice(2,e.length-1):e}))),r.register(Y.SELECTOR,new Me((function(e){return e.split("/")}))),r.register(Y.FLOAT_LITERAL,new _e((function(e){return parseFloat(e.text)}),(function(){return"float"}))),r.register(Y.INT_LITERAL,new _e((function(e){return parseInt(e.text,10)}),(function(){return"int"}))),r.register(Y.STRING_LITERAL,new _e((function(e){return e.text.slice(1,e.text.length-1)}),(function(){return"string"}))),r.register(Y.QUESTION,new ke(Re.CONDITIONAL)),r.register(Y.LEFT_PAREN,new Ee(Y.RIGHT_PAREN)),r.register(Y.LEFT_PAREN,new ye(Y.RIGHT_PAREN,Y.COMMA,Re.CALL)),r.infixRight(Y.COMPARISON,Re.CONDITIONAL),r.infixLeft(Y.BOOLEAN_AND,Re.BOOLEAN_OP),r.infixLeft(Y.BOOLEAN_OR,Re.BOOLEAN_OP),r.infixLeft(Y.PLUS,Re.SUM),r.infixLeft(Y.MINUS,Re.SUM),r.infixLeft(Y.ASTERISK,Re.PRODUCT),r.infixLeft(Y.SLASH,Re.PRODUCT),r.infixLeft(Y.MODULO,Re.EXPONENT),r}return Object(ee.a)(n,[{key:"postfix",value:function(e,t){this.register(e,new Se(t))}},{key:"prefix",value:function(e,t){this.register(e,new Ce(t))}},{key:"infixLeft",value:function(e,t){this.register(e,new Oe(t,!1))}},{key:"infixRight",value:function(e,t){this.register(e,new Oe(t,!0))}}]),n}(Le),Fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(c.a)({type:Object,blackbox:!0,custom:function(){var e=this.value;if(void 0!==e){if("string"===typeof e)return"notAllowed";for(var t=Object.keys(e),n=0;n<t.length;n+=1){if("string"!==typeof e[t[n]])return"notAllowed"}}}},e)},Be=Fe,Ue=Be({optional:!0}),Ge=Fe({optional:!0}),Ve=function(){try{var e=new be(this.value);new Pe({tokens:e}).parseExpression()}catch(t){this.addValidationErrors([{name:this.key,type:"Invalid formula: ".concat(t.message),value:this.value}])}},$e=new m.a({type:{type:String},name:{type:String,optional:!0,custom:function(){if(!["end_group","end_repeat"].includes(this.field("type").value)){var e=m.a.ErrorTypes.REQUIRED;if(this.operator){if(this.isSet){if("$set"===this.operator&&null===this.value||""===this.value)return e;if("$unset"===this.operator)return e;if("$rename"===this.operator)return e}}else if(!this.isSet||null===this.value||""===this.value)return e}}},constraint:{type:String,optional:!0,custom:Ve},constraint_message:Ue,label:Ue,image:Ue,video:Ue,hint:Ue,guidance_hint:Ue,required_message:Ue,relevant:{type:String,optional:!0,custom:Ve},choice_filter:{type:String,optional:!0},calculation:{type:String,optional:!0,custom:Ve},trigger:{type:String,optional:!0,custom:Ve},readonly:{type:String,optional:!0},required:{type:String,optional:!0,custom:Ve},parameters:{type:String,optional:!0},repeat_count:{type:String,optional:!0,custom:Ve},appearance:{type:String,optional:!0},default:{type:String,optional:!0},instance:Ge,bind:Ge,body:Ge}),ze=new m.a({"list name":{type:String},name:{type:String},label:Be()}),He=new m.a({form_title:{type:String,optional:!0},form_id:{type:String,optional:!0},public_key:{type:String,optional:!0},submission_url:{type:String,optional:!0},default_language:{type:String,optional:!0},version:{type:String,optional:!0}});function Ke(e){return $e.validate(e)}var We=r.createContext({onDropNode:function(){}});function qe(e){var t=function(){throw new Error("Given data is not a valid ODK node.")};"object"!==typeof e&&t(),Ke(e.row),"string"===typeof e.type&&e.typeParameters instanceof Array&&e.typeParameters.every((function(e){return"string"===typeof e}))&&"number"===typeof e.indentationLevel&&"number"===typeof e.rowIndex&&(void 0===e.resultIsInvalid||"boolean"===typeof e.resultIsInvalid)||t(),e.children.forEach(qe)}function Xe(e,t){if(!I(t))throw new Error("Getting the last row index of a group only works with rows that are groups.");var n=t.children.length>0,r=n?e.flatNodes.findIndex((function(e,n){return n>t.rowIndex&&e===t})):-1;if(n&&-1===r)throw new Error("Node has children, but its end marker row could not be found in the \u2018survey\u2019 sheet. Please ensure the node is actually part of the survey.");return r}var Je,Qe=0;function Ye(e){var t=e.node,n=e.position,o=e.icon,a=Object(r.useContext)(y),i=Object(B.jsxs)(B.Fragment,{children:["Add field ",Object(B.jsx)("strong",{children:n})," ",Object(B.jsx)(p.g,{children:t.row.name})]}),c=Object(r.useCallback)((function(){var e=a.xlsForm;if(e){var r={type:"text",name:"untitled_field_".concat(Qe++),label:A("",e.languages)},o=0;o=I(t)?{after:Xe(e,t)+1,before:t.rowIndex,inside:t.rowIndex+1}[n]:{after:t.rowIndex+1,before:t.rowIndex,inside:0}[n],a.onSpliceRows("survey",o,0,r)}}),[a,t,n]);return Object(B.jsx)(p.B,{icon:o,onClick:c,text:i})}function Ze(e){var t=e.node,n=e.onRemove,o=Object(r.useCallback)((function(){n(t)}),[t,n]),a=I(t);return Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(p.z,{children:[Object(B.jsx)(Ye,{node:t,position:"before",icon:"arrow-up"}),a&&Object(B.jsx)(Ye,{node:t,position:"inside",icon:"add"}),Object(B.jsx)(Ye,{node:t,position:"after",icon:"arrow-down"}),Object(B.jsx)(p.A,{}),Object(B.jsx)(p.B,{icon:"group-objects",text:"Nest in group",onClick:o,disabled:!0}),Object(B.jsx)(p.B,{icon:"ungroup-objects",text:"Ungroup",onClick:o,disabled:!0}),Object(B.jsx)(p.A,{}),Object(B.jsx)(p.B,{intent:"danger",icon:"trash",text:"Remove field",onClick:o})]})})}var et=v.a.code(Je||(Je=Object(f.a)(['\n  font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",\n    "Courier New", monospace;\n\n  .expression.has-error {\n    text-decoration: underline wavy ',";\n    text-decoration-skip: none;\n    text-decoration-skip-ink: none;\n    text-decoration-color: "," !important;\n\n    a {\n      text-decoration: underline wavy ",";\n      text-decoration-skip: none;\n      text-decoration-skip-ink: none;\n      text-decoration-color: "," !important;\n    }\n  }\n\n  .expression-name {\n    color: ",";\n  }\n\n  &.expression-call > .expression-name:first-child,\n  .expression-call > .expression-name:first-child {\n    color: ",";\n  }\n\n  .expression-name {\n    word-break: break-word;\n  }\n\n  .token-STRING_LITERAL {\n    color: ",";\n  }\n\n  .token-NUMBER_LITERAL {\n    color: ",";\n  }\n\n  .token-COMMA {\n    color: ",";\n  }\n\n  .token-LEFT_PAREN,\n  .token-RIGHT_PAREN {\n    color: ",";\n    font-weight: bold;\n  }\n\n  .token-INVALID {\n    border: 2px "," solid;\n    padding: 2px;\n    margin: -2px;\n    color: ",';\n  }\n\n  .token-COMMA::after {\n    content: "\xa0";\n  }\n\n  .expression-operator {\n    clear: left;\n  }\n\n  .token-COMPARISON {\n    &::after,\n    &::before {\n      content: "\u2002";\n    }\n    font-weight: bold;\n    color: ',";\n  }\n\n  .token-COLON,\n  .token-BOOLEAN_AND,\n  .token-BOOLEAN_OR,\n  .token-PLUS,\n  .token-GREATER_THAN,\n  .token-LESS_THAN,\n  .token-MODULO,\n  .token-QUESTION {\n    word-break: break-word;\n    display: block;\n    font-weight: bold;\n    color: ",";\n  }\n"])),k.a.RED2,k.a.RED2,k.a.RED2,k.a.RED2,k.a.GREEN3,k.a.BLUE3,k.a.ORANGE3,k.a.ORANGE4,k.a.GRAY1,k.a.BLUE2,k.a.RED5,k.a.RED5,k.a.RED2,k.a.RED2);function tt(e){var t=e.token,n=e.expression,o=e.parentExpression,a=e.node,i="token token-".concat(Y[t.type]),c=r.useContext(y);if(t.type===Y.NAME&&"call"===(null===o||void 0===o?void 0:o.kind)&&n instanceof ge&&t===o.tokens[0])return Object(B.jsx)("a",{href:"https://getodk.github.io/xforms-spec/#fn:".concat(t.text),className:i,target:"docs",children:t.text});if(t.type===Y.NAME&&n instanceof ge&&t.text.startsWith("$")&&c.context){var s=$(n.name,c.context,a)||V(n.name,c.context,c.context.survey);return!s||s instanceof Array?Object(B.jsx)("span",{className:i,"data-referenced-node":s,children:t.text}):Object(B.jsxs)(B.Fragment,{children:["${",Object(B.jsx)(Lt,{node:s,editable:!1,nameOfOnlyShownTab:"calculation"}),"}"]})}return Object(B.jsx)("span",{className:i,children:t.text})}function nt(e){var t;if(!e.tokens)return Object(B.jsx)(et,{style:e.style,className:"".concat(e.className||""," expression expression-invalid"),children:e.code});var n=e.tokens[e.tokens.length-1],r=n.index+n.text.length;return Object(B.jsxs)(et,{style:e.style,className:"".concat(e.className||""," expression expression-invalid"),children:[e.tokens.map((function(t){return Object(B.jsx)(tt,{token:t,node:e.node},t.index)})),Object(B.jsx)("span",{className:E.a.TEXT_DISABLED,children:null===(t=e.code)||void 0===t?void 0:t.slice(r)})]})}function rt(e){if(!e.expression)return Object(B.jsx)(nt,Object(c.a)({},e));var t=e.error instanceof ae&&e.error.expression===e.expression;return Object(B.jsx)(et,{style:e.style,className:"".concat(e.className||""," expression expression-").concat(e.expression.kind," ").concat(t?"has-error":""),children:e.expression.children.map((function(t,n){return t instanceof he?Object(B.jsx)(rt,{code:t.tokens.map((function(e){return e.text})).join(""),expression:t,parentExpression:e.expression,tokens:t.tokens,error:e.error,node:e.node}):Object(B.jsx)(tt,{token:t,expression:e.expression,parentExpression:e.parentExpression,node:e.node},t.index)}))})}function ot(e){var t=e.split(/\n/).find((function(e){return e.replace(/\s/,"").length>0}));if(!t)return e;var n=t.match(/^\s+/);if(!n)return e;var r=n[0];if(!r)return e;var o=new RegExp("^".concat(r));return e.split(/\n/).map((function(e){return e.replace(o,"")})).join("\n")}var at=n(154),it=n.n(at);function ct(e){var t;return"string"!==typeof e.children?Object(B.jsx)(p.e,{intent:"danger",children:"Markdown content must be a string."}):Object(B.jsx)("div",Object(c.a)(Object(c.a)({},Object(G.omit)(e,"children","marked")),{},{dangerouslySetInnerHTML:{__html:null===(t=e.marked)||void 0===t?void 0:t.call(e,ot(e.children))}}))}var st,lt=function(e){return Object(B.jsx)(ct,Object(c.a)(Object(c.a)({},e),{},{marked:it.a}))},ut=Object(v.a)(lt)(st||(st=Object(f.a)(['\n  h1,\n  h2,\n  h3,\n  h4,\n  h5 {\n    margin: 1em 0;\n  }\n\n  code,\n  pre {\n    font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",\n      "Courier New", monospace;\n    color: ',";\n    /* border: 1px solid rgba(0, 0, 0, 0.2); */\n    margin: -1px;\n    padding: 2px 3px;\n    background-color: rgba(255, 255, 255, 0.3);\n  }\n\n  pre {\n    padding: 0.5em 0.55em;\n    margin: 0.5em 0;\n    line-height: 1.3em;\n    background: white;\n    white-space: pre-wrap;\n  }\n\n  code {\n    font-weight: 600;\n  }\n\n  p {\n    margin-block-end: 16px;\n  }\n  p:last-child {\n    margin-block-end: 0;\n  }\n\n  ul,\n  ol {\n    margin: 1em 1.25em;\n  }\n"])),k.a.DARK_GRAY1),dt=n(59);n(398),n(403);function ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=Object(dt.d)(e);return n.opacity*=t,n.toString()}function ft(e){var t,n,o,a,i=e.node,s=e.columnName,l=e.nodeEvaluationResults,u=e.style,d=r.useContext(y),h=i.row[s],f=null===l||void 0===l?void 0:l.get(s),b=void 0===h,j="literal"===(null===f||void 0===f||null===(t=f.expression)||void 0===t?void 0:t.kind),v="name"===(null===f||void 0===f||null===(n=f.expression)||void 0===n?void 0:n.kind),g=null===(o=d.context)||void 0===o?void 0:o.nodesToAnswers.get(i),m=d.context?W(i,d.context):i.row.name;return Object(B.jsxs)(St,{lang:"en",style:Object(c.a)({backgroundColor:k.a.LIGHT_GRAY5,marginTop:"0",padding:"20px",background:"linear-gradient(".concat(ht(k.a.BLUE3,.06),", ").concat(ht(k.a.BLUE3,.05)," 5px, ").concat(ht(k.a.BLUE3,.01)," 10px, transparent 30px)"),borderTop:"solid 1px ".concat(k.a.LIGHT_GRAY3)},u),children:[!b&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("h4",{children:[Object(B.jsx)(p.x,{icon:"function"})," ","calculation"===s?"Formula":"Condition"]}),Object(B.jsx)(Tt,{style:{fontSize:j||v?"20px":"16px",lineHeight:"28px"},children:Object(B.jsx)(rt,{node:i,state:null===f||void 0===f?void 0:f.state,error:null===f||void 0===f?void 0:f.error,expression:null===f||void 0===f?void 0:f.expression,code:String(h),tokens:null===f||void 0===f||null===(a=f.parser)||void 0===a?void 0:a.tokens})}),Object(B.jsx)("h4",{children:"Result"})]}),!b&&!f&&Object(B.jsx)(p.e,{intent:"none",children:"Not calculated yet."}),"error"!==(null===f||void 0===f?void 0:f.state)&&Object(B.jsx)(Tt,{style:{fontSize:"20px",lineHeight:"28px"},children:void 0===(null===f||void 0===f?void 0:f.result)?"undefined":JSON.stringify(f.result)}),"error"===(null===f||void 0===f?void 0:f.state)&&Object(B.jsxs)(At,{intent:"danger",children:[f.error instanceof ae&&Object(B.jsxs)(B.Fragment,{children:["Error in\xa0",Object(B.jsx)("code",{children:Object(B.jsx)(rt,{node:i,expression:f.error.expression})}),":"]}),Object(B.jsx)(ut,{children:f.error.toMarkdown()})]}),!b&&void 0!==(null===f||void 0===f?void 0:f.result)&&Object(B.jsx)(p.N,{className:E.a.TEXT_MUTED,children:{calculation:Object(B.jsx)(B.Fragment,{children:"This is the result of the formula."}),required:"This means you ".concat((null===f||void 0===f?void 0:f.result)?"can\u2019t":"can"," complete the survey without entering data in this field."),relevant:"This means the survey field is ".concat((null===f||void 0===f?void 0:f.result)?"shown":"hidden","."),readonly:"This means the survey field is ".concat((null===f||void 0===f?void 0:f.result)?"read-only":"editable","."),constraint:"This means the survey field contains an input that is ".concat((null===f||void 0===f?void 0:f.result)?"allowed":"not allowed"," by the constraint formula..")}[s]}),b&&Object(B.jsx)(p.N,{className:E.a.TEXT_MUTED,children:{calculation:void 0===g||""===g?Object(B.jsxs)(B.Fragment,{children:["This survey field has no entered answer yet, and the"," ",Object(B.jsx)("code",{children:s})," cell is empty."]}):Object(B.jsxs)(B.Fragment,{children:["This is the answer value entered in the"," ",Object(B.jsx)("code",{children:m})," field."]}),required:Object(B.jsxs)(B.Fragment,{children:["This means users are not required to enter this field. This is the default when the ",Object(B.jsx)("code",{children:s})," cell is empty."]}),relevant:Object(B.jsxs)(B.Fragment,{children:["This means the survey field is always shown. This is the default when the ",Object(B.jsx)("code",{children:s})," cell is empty."]}),readonly:Object(B.jsxs)(B.Fragment,{children:["This means the survey field is not read-only. This is the default when the ",Object(B.jsx)("code",{children:s})," cell is empty."]}),constraint:Object(B.jsxs)(B.Fragment,{children:["If the cell contains a formula that evaluates to"," ",Object(B.jsx)("code",{children:"true"}),", the field accepts any input. This is the default when the ",Object(B.jsx)("code",{children:s})," cell is empty."]})}[s]})]})}var bt,pt,jt,vt=n(64),gt={integer:"numerical",decimal:"numerical",range:"horizontal-distribution",text:"edit",select_one:"selection",select_one_from_file:"selection",select_multiple:"multi-select",select_multiple_from_file:"multi-select",rank:"sort-numerical",note:"lightbulb",geopoint:"map-marker",geotrace:"geofence",geoshape:"geofence",date:"calendar",time:"time",datetime:"time",image:"media",audio:"headset",video:"video",file:"upload",barcode:"barcode",calculate:"function",acknowledge:"switch",hidden:"eye-off","xml-external":"layout-hierarchy",start:"time",end:"time",today:"calendar",deviceid:"desktop",simserial:"sim-card",subscriberid:"id-number",phonenumber:"phone",username:"person",email:"envelope",audit:"shield",begin_group:"group-objects",begin_repeat:"repeat"},mt={integer:"Integer number",decimal:"Decimal number",range:"Slider",text:"Text field",select_one:"Single choice",select_one_from_file:"Single choice from file",select_multiple:"Multiple choice",select_multiple_from_file:"Multiple choice from file",rank:"Rank items",note:"Note / Hint",geopoint:"Locate a point",geotrace:"Trace a line",geoshape:"Draw a shape",date:"Date",time:"Time",datetime:"Date and time",image:"Image",audio:"Audio",video:"Video",file:"File",barcode:"Scan a code",acknowledge:"Checkbox",calculate:"Calculate formula",hidden:"Hidden field","xml-external":"External XML reference",start:"Survey start date and time",end:"Survey submission date and time",today:"Survey start day",deviceid:"Device ID",simserial:"SIM serial number",subscriberid:"Subscriber ID",phonenumber:"Phone number",username:"Username",email:"Email address",audit:"Audit trail",begin_group:"Field group",begin_repeat:"Repeat group"},Ot={literal:"edit",choice:"selection",geo:"globe",time:"time",media:"upload",stats:"scatter-plot",track:"person",special:"small-minus",grouping:"layout-hierarchy"},xt={literal:"Enter value",choice:"Choice",geo:"Maps",time:"Date and time",media:"Upload",special:"Other",stats:"Statistics",track:"Personal data",grouping:"Grouping"},yt={text:"literal",acknowledge:"literal",integer:"literal",decimal:"literal",range:"literal",barcode:"literal",select_one:"choice",select_one_from_file:"choice",select_multiple:"choice",select_multiple_from_file:"choice",rank:"choice",geopoint:"geo",geotrace:"geo",geoshape:"geo",date:"time",time:"time",datetime:"time",image:"media",audio:"media",video:"media",file:"media",note:"special",calculate:"special",hidden:"special","xml-external":"special",start:"stats",end:"stats",today:"stats",deviceid:"track",simserial:"track",subscriberid:"track",phonenumber:"track",username:"track",email:"track",audit:"track",begin_group:"grouping",begin_repeat:"grouping"};function wt(e){var t=e.xlsForm,n=e.node,o=null===t||void 0===t?void 0:t.choicesByName,a=o?Object.keys(o):[],i=r.useContext(y),s=r.useCallback((function(e){var t=e.currentTarget.checked,r=e.currentTarget.value,o=Object(u.a)(n.typeParameters);t?o.push(r):o=Object(G.without)(o,r);var a=[n.type].concat(Object(u.a)(o)).join(" "),s=Object(c.a)(Object(c.a)({},n.row),{},{type:a});i.onSpliceRows("survey",n.rowIndex,1,s)}),[i,n]);return Object(B.jsxs)(p.z,{children:[Object(B.jsx)("li",{className:"bp3-menu-header",children:Object(B.jsx)("h6",{className:"bp3-heading",children:"Which choice lists should be visible?"})}),Object(B.jsx)(p.i,{style:{margin:"16px 8px 4px"},vertical:!0,children:a.map((function(e){var t=n.typeParameters.includes(e),r=e,a=o[e],i=Object.keys(a),c=Object(G.sortBy)(i.map((function(e){return a[e]})),(function(e){return e.name.toLowerCase()})),l=c.slice(0,4).map((function(e){return Object(B.jsx)("li",{children:Object(B.jsx)(p.g,{style:{marginInline:"1px"},children:e.name},e.name)})})),u=c.length>4&&Object(B.jsxs)("span",{className:E.a.UI_TEXT,style:{lineHeight:"24px",marginLeft:"4px",paddingRight:"2px"},"aria-label":"and ".concat(c.length-4," more"),children:["+ ",c.length-4]}),d=Object(B.jsxs)(p.i,{fill:!0,style:{display:"inline-flex"},children:[Object(B.jsx)("header",{"aria-label":"Choice list ".concat(e,", allowed values:"),children:Object(B.jsx)(p.N,{children:r})}),Object(B.jsx)("ul",{className:E.a.LIST_UNSTYLED,children:Object(B.jsxs)(p.i,{style:{justifyContent:"flex-end",marginLeft:"16px"},children:[l,u]})})]});return Object(B.jsx)(p.f,{value:e,onChange:s,large:!0,checked:t,disabled:1===n.typeParameters.length&&e===n.typeParameters[0],children:d})}))}),Object(B.jsxs)(p.e,{intent:"primary",children:["These lists are defined in the ",Object(B.jsx)("code",{children:"choices"})," Excel sheet."]})]})}function kt(){var e=r.useContext(y),t=r.useContext(D).node,n=r.useCallback((function(n){var r=n.currentTarget.dataset.type,o=(null===r||void 0===r?void 0:r.match(/^select/))?t.typeParameters:[],a=[r].concat(Object(u.a)(o)).join(" "),i=Object(c.a)(Object(c.a)({},t.row),{},{type:a});e.onSpliceRows("survey",t.rowIndex,1,i)}),[e,t]);return Object(B.jsxs)(p.z,{children:[Object(B.jsx)("li",{className:"bp3-menu-header",children:Object(B.jsx)("h6",{className:"bp3-heading",children:"Collecting data"})}),Object.keys(Ot).filter((function(e){return"special"!==e&&"grouping"!==e})).map((function(e){return Object(B.jsx)(p.B,{text:xt[e],icon:Ot[e],children:Object.keys(yt).filter((function(t){return yt[t]===e})).map((function(e){return Object(B.jsx)(p.B,{text:mt[e],icon:gt[e],onClick:n,"data-type":e})}))})})),Object(B.jsx)(p.A,{}),Object.keys(yt).filter((function(e){return"special"===yt[e]})).map((function(e){return Object(B.jsx)(p.B,{text:mt[e],icon:gt[e],onClick:n,"data-type":e})}))]})}function Et(e){var t=e.node,n=e.showType,o=I(t),a=r.useContext(y).xlsForm,i=!!a&&Object.keys(null===a||void 0===a?void 0:a.choicesByName).length>0,c=a&&Object(B.jsx)(wt,{xlsForm:a,node:t}),s=function(){var e=r.useContext(y),t=r.useCallback((function(){var t,n=(null===(t=e.xlsForm)||void 0===t?void 0:t.languages)||new Set(["English (en)"]),r=[{"list name":"yes_no_maybe",name:"yes",label:A("yes",n)},{"list name":"yes_no_maybe",name:"no",label:A("no",n)},{"list name":"yes_no_maybe",name:"maybe",label:A("maybe",n)}];e.onSpliceRows.apply(e,["choices",0,0].concat(r))}),[e]),n=Object(B.jsx)(p.c,{large:!0,intent:"primary",onClick:t,children:"Create example choice list"});return Object(B.jsx)(p.i,{style:{padding:"16px"},children:Object(B.jsx)(p.D,{icon:"selection",action:n,title:"Sometimes, we have no choice.",description:Object(B.jsx)(B.Fragment,{children:"This survey has no choice lists yet. Please add one first to make it available for this survey question."})})})}(),l=mt[t.type],u=gt[t.type],d=t.typeParameters.length>0;return Object(B.jsxs)(p.d,{children:[n&&Object(B.jsx)(B.Fragment,{children:o?Object(B.jsxs)(p.N,{className:E.a.TEXT_MUTED,children:[Object(B.jsx)(p.x,{icon:u}),"\xa0",l]}):Object(B.jsx)(N.a,{content:Object(B.jsx)(kt,{}),lazy:!0,children:Object(B.jsx)(p.c,{icon:u||"blank",fill:!1,minimal:o,disabled:o,small:o,rightIcon:!o&&"caret-down",children:l})})}),t.type.match(/^select/)&&Object(B.jsx)(N.a,{lazy:!0,content:i?c:s,children:Object(B.jsxs)(p.c,{fill:!0,outlined:!1,rightIcon:"caret-down",intent:d?"none":"warning",children:[!d&&"Set visible choices",d&&Object(B.jsx)(p.F,{observeParents:!0,minVisibleItems:2,collapseFrom:vt.a.END,items:t.typeParameters,visibleItemRenderer:function(e){return Object(B.jsx)(p.g,{children:e})},overflowRenderer:function(e){return Object(B.jsx)("span",{children:"+ ".concat(e.length)})},style:{transition:"width 0.1s ease-out",maxWidth:"200px"}})]})})]})}function Nt(e){var t=e.path,n=e.width;return Object(B.jsx)(p.b,{items:t.map((function(e,n){return{href:"#//".concat(t.slice(0,n+1).join("/")),text:e}})),collapseFrom:"start",overflowListProps:{minVisibleItems:1,style:{transition:"width 0.1s ease-out",width:"".concat(n,"px")}}})}var Tt=Object(v.a)(p.g)(bt||(bt=Object(f.a)(["\n  overflow: auto;\n  word-break: break-all;\n  font-size: 16px;\n  line-height: 20px;\n  display: block;\n  border: none;\n  box-shadow: none;\n  background: transparent;\n  padding: 0;\n"]))),St=v.a.div(pt||(pt=Object(f.a)(["\n  display: grid;\n  gap: 8px;\n\n  h1,\n  h2,\n  h3,\n  h4,\n  h5 {\n    margin: 0;\n    &:not(:first-child) {\n      margin-top: 8px;\n    }\n  }\n"]))),At=Object(v.a)(p.e)(jt||(jt=Object(f.a)(['\n  > code,\n  pre {\n    font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",\n      "Courier New", monospace;\n    color: ',';\n    /* border: 1px solid rgba(0, 0, 0, 0.2); */\n    margin: -1px;\n    padding: 2px 4px;\n    background-color: rgba(255, 255, 255, 0.3);\n  }\n\n  pre {\n    padding: 0.5em 0.55em;\n    margin: 0.5em 0;\n    line-height: 1.3em;\n    background: white;\n    white-space: pre-wrap;\n  }\n\n  code {\n    font-weight: 600;\n    font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",\n      "Courier New", monospace;\n  }\n'])),k.a.DARK_GRAY1);function Ct(e){e.isOpen;var t=e.ref,n=e.detailsButtonCaption,o=Object(w.a)(e,["isOpen","ref","detailsButtonCaption"]),a=r.useContext(y),i=r.useContext(D),s=i.node,l=i.nodeEvaluationResults,u=R(s,a.context),d=s.type.match(/^select/)&&0===s.typeParameters.length,f=!!S(l),b=r.useState(!1),j=Object(h.a)(b,2),v=j[0],g=j[1],m=function(e){var t=e.context,n=e.node,o=e.setIsDraggedOver,a=r.useContext(We).onDropNode,i=r.useCallback((function(e){t&&e.dataTransfer.setData("application/json",JSON.stringify({sourceNode:n,sourcePath:W(n,t)}))}),[t,n]),c=r.useCallback((function(e){e.preventDefault(),t&&(e.dataTransfer.getData("application/json"),o(!0))}),[t,o]),s=r.useCallback((function(e){if(t){var r=W(n,t),i=JSON.parse(e.dataTransfer.getData("application/json")),c=i.sourcePath,s=i.sourceNode;qe(s),console.log("Dropped on path",r),o(!1),a({sourceNode:s,sourcePath:c,destinationNode:n,position:"before"})}}),[t,n,a,o]);return{draggable:!0,onDragStart:i,onDragOver:c,onDragLeave:r.useCallback((function(e){if(t){var r=W(n,t);console.log("Left dragging at path",r),o(!1)}}),[t,n,o]),onDrop:s}}({context:a.context,node:s,setIsDraggedOver:g});return t?Object(B.jsx)(p.i,Object(c.a)(Object(c.a)({style:{display:"inline-flex",flex:"none",borderTop:v?"5px solid ".concat(k.a.BLUE3):"none"}},m),{},{children:Object(B.jsx)(p.c,Object(c.a)(Object(c.a)({},o),{},{elementRef:t,minimal:!0,small:!0,lang:"en",intent:f?"danger":d?"warning":"none",icon:f?"error":void 0,style:{color:f||d?void 0:"inherit",fontSize:"inherit",padding:0},className:[!f&&!u&&E.a.TEXT_MUTED].filter(Boolean).join(" "),children:Object(B.jsxs)(p.i,{children:[n||Object(B.jsx)("code",{style:{color:"inherit"},children:s.row.name}),!u&&Object(B.jsxs)(B.Fragment,{children:["\xa0",Object(B.jsx)(p.x,{icon:"eye-off",style:{opacity:.5,color:"inherit"}})]})]})}))})):Object(B.jsx)("div",{})}function Lt(e){var t,n=e.node,o=e.editable,a=e.nameOfOnlyShownTab,i=r.useContext(y),c=null===(t=i.context)||void 0===t?void 0:t.evaluationResults.get(n),s=S(c),l=n.row,u=L.find((function(e){var t=l[e];return"string"===typeof t&&t.length>0})),d=r.useState(100),f=Object(h.a)(d,2),b=f[0],j=f[1],v=r.useCallback((function(e){setTimeout((function(){var t,n=null===(t=e[0])||void 0===t?void 0:t.contentRect.width;Math.abs(n-b)>10&&j(n)}),50)}),[b]),g=r.useState(s||u||"calculation"),m=Object(h.a)(g,2),O=m[0],x=m[1],w=U(),k=w.alert,A=w.showRemoveConfirmationDialog;if(!i.context)return null;var C=K(n,i.context).slice(1),R=Object(B.jsxs)(p.i,{style:{marginBottom:"16px"},children:[Object(B.jsx)(Et,{node:n,showType:!0}),Object(B.jsx)("div",{className:E.a.FLEX_EXPANDER}),Object(B.jsx)(N.a,{content:Object(B.jsx)(Ze,{node:n,onRemove:A}),lazy:!0,children:Object(B.jsx)(p.c,{fill:!1,rightIcon:"caret-down",children:"Actions"})})]}),I=Object(B.jsxs)(p.i,{vertical:!0,children:[o&&R,Object(B.jsx)(p.J,{onResize:v,observeParents:!0,children:Object(B.jsx)(p.i,{style:{width:"100%",marginBottom:"8px"},children:Object(B.jsx)(Nt,{path:C,width:b})})}),a?Object(B.jsx)(ft,{node:n,columnName:a,nodeEvaluationResults:c,style:{margin:"0 -20px -20px -20px"}}):Object(B.jsx)(p.M,{onChange:x,selectedTabId:O,renderActiveTabPanelOnly:!1,children:L.map((function(e){return function(e){var t=e.nodeEvaluationResults,n=e.node,r=e.columnName,o=null===t||void 0===t?void 0:t.get(r),a=Object(B.jsx)(ft,{node:n,columnName:r,nodeEvaluationResults:t,style:{margin:"-20px"}});return Object(B.jsx)(p.L,{id:r,panel:a,title:Object(B.jsxs)(B.Fragment,{children:[r,"error"===(null===o||void 0===o?void 0:o.state)&&Object(B.jsxs)(B.Fragment,{children:["\xa0",Object(B.jsx)(p.x,{icon:"warning-sign",intent:"warning"})]})]})})}({node:n,nodeEvaluationResults:c,columnName:e})}))})]});return Object(B.jsxs)(D.Provider,{value:{node:n,nodeEvaluationResults:c},children:[k,Object(B.jsx)(N.a,{lazy:!0,interactionKind:"click",popoverClassName:T.a.POPOVER2_CONTENT_SIZING,minimal:!1,placement:"bottom",rootBoundary:"viewport",onOpening:function(){return j(0)},modifiers:{arrow:{enabled:!0},preventOverflow:{enabled:!0}},content:I,fill:!0,renderTarget:Ct})]})}function Rt(e){var t,n,o=e.node,a=r.useContext(y),i=null===(t=a.context)||void 0===t?void 0:t.evaluationResults.get(o);if(!i)return Object(B.jsx)(p.x,{icon:"calculator",intent:"none"});var c=L.filter((function(e){var t;return null===(t=i.get(e))||void 0===t?void 0:t.error})),s=null===(n=a.context)||void 0===n?void 0:n.nodesToAnswers.get(o),l=void 0===s?null:JSON.stringify(s),u=Object(B.jsx)("span",{children:l}),d="Node has errors in the following columns: ".concat(c.map((function(e){return"\u2018".concat(e,"\u2019")})).join(", ")),h=c.length?Object(B.jsx)(p.x,{icon:"error",intent:"danger",title:d,htmlTitle:d}):null;return Object(B.jsxs)(B.Fragment,{children:[u,h]})}function It(e,t,n){return 0===e.children.length?n({id:K(e,t).join("."),label:e.row.name,childNodes:[],nodeData:e}):n({id:K(e,t).join("."),label:e.row.name,childNodes:e.children.map((function(e){return It(e,t,n)})),nodeData:e})}function _t(e){var t=e.xlsForm,n=r.useContext(y),o=n.context,a=r.useMemo((function(){return t&&o?It(t.rootSurveyGroup,o,(function(e){var t,r=e.nodeData;if(!r)throw new Error("Encountered a tree node that is not associated with a node. Please fix this.");if(!n.context)throw new Error("No context defined. Please define a context before using this component.");W(r,n.context);var o=Object(B.jsx)(Lt,{node:r,editable:!0});return Object(c.a)(Object(c.a)({},e),{},{label:o,key:r.row.name,isExpanded:!0,hasCaret:!(0===(null===(t=e.childNodes)||void 0===t?void 0:t.length)),secondaryLabel:r&&Object(B.jsx)(Rt,{node:r})})})):null}),[n.context,o,t]);return a?Object(B.jsx)(p.P,{contents:[a]}):Object(B.jsx)("div",{})}var Dt=n(106);function Mt(e){var t=r.useCallback((function(t){var n=t.target.files[0],r=new Dt.Workbook,o=new FileReader;o.readAsArrayBuffer(n),o.onload=function(){var t=o.result;if(!(t instanceof ArrayBuffer))throw new Error("Buffer was not defined as Buffer object after reading.");r.xlsx.load(t).then((function(t){console.log(t,"workbook instance"),e.onLoadWorkbook(r)}))}}),[e]);return Object(B.jsx)(p.m,{onInputChange:t})}var Pt=n(400).a.ofType(),Ft=function(e,t){return Object(B.jsx)(p.B,{text:e,onClick:t.handleClick,shouldDismissPopover:!1})};function Bt(e){var t=r.useCallback((function(t){e.onChange(t)}),[e]);return Object(B.jsx)(Pt,{items:e.languages,itemRenderer:Ft,activeItem:e.language,noResults:Object(B.jsx)(p.B,{disabled:!0,text:"No languages loaded yet."}),onItemSelect:t,filterable:!1,children:Object(B.jsx)(p.c,{text:e.language,rightIcon:"double-caret-vertical"})})}function Ut(e){return Object(B.jsx)("div",Object(c.a)(Object(c.a)({},e),{},{style:Object(c.a)({overflow:"auto",flex:1},e.style),children:e.children}))}var Gt=n(65),Vt=n(156),$t=n(10);function zt(e,t,n){var r=Object(c.a)({},e),o=new Set;return n&&t.forEach((function(e){r[e]&&(r["".concat(e,"::").concat(n)]=r[e]),o.add(n),delete r[e]})),t.forEach((function(e){Object.keys(r).filter((function(t){return t.startsWith(e)})).forEach((function(e){var t=e.split(/::/),n=Object(h.a)(t,2),a=n[0],i=n[1],c=r[a],s=String(r[e]);if(void 0===c)r[a]=Object($t.a)({},i,s),o.add(i);else{if("object"!==typeof c)throw new se("Can't handle `".concat(a,"` column. Columns with prefix `").concat(a,"` must be namespaced with `::`. See chapter [\u2018Advanced use and extensibility\u2019](https://xlsform.org/en/#advanced-use-and-extensibility) in the documentation."));c[i]=s,o.add(i)}delete r[e]}))})),{result:r,foundSuffixes:o}}function Ht(e){return e.replace(/^media::(image|audio|video)\B/,"$1").replace(/^imei$/,"deviceid").replace(/^phone_number$/,"phonenumber").replace(/^select one\B/,"select_one").replace(/^select multiple\B/,"select_multiple").replace(/^location$/,"geopoint").replace(/^photo\B/,"image").replace(/^trigger$/,"acknowledge").replace(/^begin group$/,"begin_group").replace(/^end group$/,"end_group").replace(/^begin repeat$/,"begin_repeat").replace(/^end repeat$/,"end_repeat")}var Kt={getAutoValues:!0,trimStrings:!0,mutate:!1};function Wt(e){var t=$e.clean(Object(c.a)(Object(c.a)({},e),{},{type:Ht(String(e.type))}),Kt);return Ke(t),t}function qt(e){var t=ze.clean(e,Object(c.a)(Object(c.a)({},Kt),{},{filter:!1}));return function(e){ze.validate(e,{keys:["list name","name"]})}(t),t}function Xt(e){var t=He.clean(e,Kt);return function(e){He.validate(e)}(t),t}var Jt=["label","hint","constraint_message","required_message","image","audio","video"];function Qt(e,t,n,r){var o=e.getWorksheet(t),a=[];if(o){var i=o.getRows(1,1)[0];if(!(i.values instanceof Array))throw new se("First row of the \u2018".concat(t,"\u2019 worksheet must be an array structure, but is a ").concat(typeof i.values," instead. Please fix this."));var c=i.values.slice(1).map((function(e){return(null===e||void 0===e?void 0:e.toString())||""})),s=function(e){for(var t=[],n=0;n<e.length;n+=1){var r,o=(null===(r=e[n])||void 0===r?void 0:r.toString())||"";t.push(o.replace(/^constraint-msg\B/,"constraint_message").replace(/^requiredMsg\B/,"required_message").replace(/^bind::required$/,"required").replace(/^repeat-count$/,"repeat_count").replace(/^media::(image|audio|video)\B/,"$1").replace(/^photo\B/,"image").replace(/^list_name$/,"list name"))}return Object.freeze(t)}(c),l=function(e,t){var n={};return e.forEach((function(e){n[e]=!0})),zt(n,Jt,t).foundSuffixes}(s,r);return o.eachRow((function(e,t){1!==t&&a.push(function(e){var t=e.row,n=e.columnNames,r=e.defaultLanguage,o=e.loadRowFn,a={};t.values.slice(1).forEach((function(e,t){var r=n[t];a[r]="".concat(e)}));var i=zt(a,Jt,r),c=zt(i.result,["instance","bind","body"]).result;try{return o(c)}catch(s){throw new se("Could not load row ".concat(JSON.stringify(c,null,2),": ").concat(s," / ").concat(JSON.stringify(s.details)))}}({row:e,columnNames:s,defaultLanguage:r,loadRowFn:n}))})),{rows:a,languages:l,columnNames:c,columnNamesNormalized:s}}}function Yt(e){return Zt.apply(this,arguments)}function Zt(){return(Zt=Object(d.a)(l.a.mark((function e(t){var n,r,o,a,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Qt(t,"settings",Xt),r=(null===n||void 0===n?void 0:n.rows[0].default_language)||"English (en)",o=Qt(t,"choices",qt,r),a=Qt(t,"survey",Wt,r)){e.next=6;break}throw new Error("No `survey` sheet found in workbook. Please define a sheet named `survey` and try again.");case 6:return i=nn(a,r,n,o),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function en(e,t){if(e.type.match(/^end[ _](?:group|repeat)$/))throw new le("Found '".concat(e.type,"' without a matching start marker in row ").concat(t+2,". Please check that the group/repeat nesting is correct. The row: ").concat(e))}function tn(e){var t={};return e.rows.forEach((function(e){var n=e["list name"],r=e.name,o=t[n]||{};o[r]=e,t[n]=o})),t}function nn(e,t,n,r){var o=[];return{worksheets:{settings:n,choices:r,survey:e},rootSurveyGroup:function(e){for(var t=e.rows,n=e.defaultLanguage,r=e.formRootNameFromSettings,o=void 0===r?"data":r,a=e.titleFromSettings,i=void 0===a?"":a,c=e.onRow,s={children:[],type:"",typeParameters:[],rowIndex:-1,indentationLevel:0,row:{name:o,type:"",label:Object($t.a)({},n,i)}},l=[s],u=0;u<t.length;){var d=t[u],h=Ht(d.type).split(" "),f=Object(Vt.a)(h),b=f[0],p=f.slice(1),j=l[l.length-1];if("begin_group"===j.type&&"end_group"===b)l.pop(),null===c||void 0===c||c(d,j);else if("begin_repeat"===j.type&&"end_repeat"===d.type)l.pop(),null===c||void 0===c||c(d,j);else if(b.match(/^begin_(?:repeat|group)$/)){var v={row:d,type:b,typeParameters:p,children:[],indentationLevel:l.length-1,rowIndex:u};j.children.push(v),l.push(v),null===c||void 0===c||c(d,v)}else{en(d,u);var g={row:d,type:b,typeParameters:p,indentationLevel:l.length-1,rowIndex:u,children:[]};j.children.push(g),null===c||void 0===c||c(d,g)}u+=1}return{node:s}}({rows:e.rows,defaultLanguage:t,onRow:function(e,t){return o.push(t)}}).node,choicesByName:r?tn(r):{},languages:e.languages,flatNodes:o}}var rn=n(78);function on(e,t){if("string"!==typeof e){var n=Object(rn.ordinalize)(String(t+1));throw new le("Expected a string value as ".concat(n," parameter, but got `").concat(e,"`."))}}function an(e,t){if("number"!==typeof e){var n=Object(rn.ordinalize)(String(t+1));throw new le("Expected a number value as ".concat(n," parameter, but got `").concat(e,"`."))}}function cn(e,t){if("boolean"!==typeof e){var n=Object(rn.ordinalize)(String(t+1));throw new le("Expected a boolean value as ".concat(n," parameter, but got `").concat(e,"`."))}}var sn={if:function(e,t,n){return cn(e,0),e?t:n},true:function(){return!0},false:function(){return!1},not:function(e){return cn(e,0),!e},coalesce:function(e,t){return"undefined"!==typeof e&&""!==e?e:"undefined"!==typeof t&&""!==t?t:""},boolean:function(e){return"number"===typeof e?0!==e:"string"===typeof e?""!==e:e instanceof Array?e.length>0:"boolean"===typeof e&&e},position:function(e){throw new ue("position")},once:function(e){throw new ue("once")},selected:function(e,t){return void 0!==e&&(on(e,0),on(t,1),0!==e.length&&0!==t.length&&e.split(" ").includes(t))},"selected-at":function(e,t){throw new ue("selected-at")},"count-selected":function(e){throw new ue("count-selected")},"jr:choice-name":function(e,t){throw new ue("jr:choice-name")},"indexed-repeat":function(e,t,n,r,o,a,i){throw new ue("):")},count:function(e){throw new ue("count")},"count-non-empty":function(e){throw new ue("count-non-empty")},sum:function(e){throw new ue("sum")},max:function(e){throw new ue("max")},min:function(e){throw new ue("min")},regex:function(e,t){return on(e,0),on(t,0),!!e.match(new RegExp(t))},contains:function(e,t){return on(e,0),on(t,1),!!e.match(t)},"starts-with":function(e,t){return on(e,0),on(t,1),e.startsWith(t)},"ends-with":function(e,t){return on(e,0),on(t,1),e.endsWith(t)},substr:function(e,t,n){return on(e,0),an(t,1),an(n,2),e.substring(t,n)},"substring-before":function(e,t){throw new ue("substring-before")},"substring-after":function(e,t){throw new ue("substring-after")},translate:function(e,t,n){throw new ue("translate")},"string-length":function(e){return on(e,0),e.length},"normalize-space":function(e){return on(e,0),e.trim()},concat:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("")},join:function(e,t){throw new ue("join")},"boolean-from-string":function(e){return"true"===e||"1"===e},string:function(e){return String(e)},round:function(e,t){return an(e,0),an(t,1),Math.round(e*Math.pow(10,t))/Math.pow(10,t)},int:function(e){return an(e,0),Math.floor(e)},number:function(e){return"boolean"===typeof e?e?1:0:"string"===typeof e&&e.trim().match(/-?\d+(\.\d+)?/)?Number(e):"number"===typeof e?e:NaN},digest:function(e,t,n){throw new ue("digest")},pow:function(e,t){return an(e,0),an(t,1),Math.pow(e,t)},log:function(e){return an(e,0),Math.log(e)},log10:function(e){return an(e,0),Math.log10(e)},abs:function(e){return an(e,0),Math.abs(e)},sin:function(e){return an(e,0),Math.sin(e)},cos:function(e){return an(e,0),Math.cos(e)},tan:function(e){return an(e,0),Math.tan(e)},asin:function(e){return an(e,0),Math.asin(e)},acos:function(e){return an(e,0),Math.acos(e)},atan:function(e){return an(e,0),Math.atan(e)},atan2:function(e,t){return an(e,0),an(t,1),Math.atan2(e,t)},sqrt:function(e){return an(e,0),Math.sqrt(e)},exp:function(e){return an(e,0),Math.exp(e)},exp10:function(e){return an(e,0),Math.pow(10,e)},pi:function(){return Math.PI},today:function(){var e=new Date;return e.setHours(0,0,0,0),e},now:function(){return(new Date).toISOString()},"decimal-date-time":function(e){throw new ue("decimal-date-time")},date:function(e){throw new ue("date")},"decimal-time":function(e){throw new ue("decimal-time")},"format-date":function(e,t){throw new ue("format-date")},"format-date-time":function(e,t){throw new ue("format-date-time")},area:function(e){throw new ue("area")},distance:function(e){throw new ue("distance")},random:Math.random,randomize:function(e,t){throw new ue("randomize")},uuid:function(e){throw new ue("uuid")},checklist:function(e,t){throw new ue("checklist")},"weighted-checklist":function(e,t,n){throw new ue("weighted-checklist")}};function ln(e,t,n){var r;if(t.stackDepth>1e4)throw new ae("Stack overflow while evaluating `".concat(JSON.stringify(e),"`"),"stackOverflow",e,t,n);var o=Object(c.a)(Object(c.a)({},t),{},{stackDepth:t.stackDepth+1});if(e instanceof Ie)r=function(e){return e.value}(e);else if(e instanceof ge)r=hn(e,o,n);else if(e instanceof De)r=function(e,t,n){var r=z(e.selector,t,n);if(r instanceof Array)return r.map((function(e){return pn(e,t,"calculation",t.nodesToAnswers.get(e))}));return r&&pn(r,t,"calculation",t.nodesToAnswers.get(r))}(e,o,n);else if(e instanceof me)r=function(e,t,n){var r,o,a=ln(e.left,t,n),i=ln(e.right,t,n),c=e.operatorToken.text;if("="===c)return a==i;if("!="===c)return a!=i;if("and"===c||"or"===c)switch("boolean"===typeof a&&(r=a),"number"===typeof a&&(r=Boolean(a)),"boolean"===typeof i&&(o=i),"number"===typeof i&&(o=Boolean(i)),dn(r,a,e,t,n),dn(o,i,e,t,n),c){case"or":return r||o;case"and":return r&&o}"number"===typeof a&&(r=a);"string"===typeof a&&(r=parseFloat(a));"number"===typeof i&&(o=i);"string"===typeof i&&(o=parseFloat(i));if("number"!==typeof r)throw new ae("Left operand is `".concat(JSON.stringify(a),"`, which is no number. Arithmetic and relative comparison operators only work with operands that are numeric."),"invalidOperandType",e,t,n);if("number"!==typeof o)throw new ae("Right operand is `".concat(JSON.stringify(i),"`, which no number. Arithmetic and relative comparison operators only work with operands that are numeric."),"invalidOperandType",e,t,n);switch(c){case"+":return r+o;case"-":return r-o;case"*":return r*o;case"div":return r/o;case"mod":return r%o;case">":return r>o;case">=":return r>=o;case"<":return r<o;case"<=":return r<=o;default:throw new ae("The `".concat(c,"` operator is not supported"),"unsupportedOperator",e,t,n)}}(e,o,n);else{if(!(e instanceof xe))throw new ae("Don\u2019t know how to evaluate `".concat(e,"`."),"unsupportedExpressionType",e,o,n);r=function(e,t,n){var r=e.fn instanceof ge?e.fn:ln(e.fn,t,n),o=void 0;if(r instanceof ge)o=hn(r,t,n,!0,sn);else{if("string"!==typeof r)throw new ae("Can\u2019t call a function without knowing its name \u2014 the name must be either defined as string, return a name string or a function reference.","functionNotFound",e,t,n);o=sn[r]}if(!o)throw new ae("Could not find a function named `".concat(un(r),"`."),"functionNotFound",e,t,n);var a=e.args.map((function(o,a){try{return ln(o,t,n)}catch(c){var i=Object(rn.ordinalize)(String(a+1));throw new ae("Error in ".concat(i," argument in `").concat(un(r),"() function call`: ").concat(c.message),"functionEvalError",e,t,n,c)}}));if("function"!==typeof o)throw new ae("Found name `".concat(o,"`, but it is not a function."),"functionNotFound",e,t,n);try{return o.apply(t,a)}catch(c){var i="";throw e.print((function(e){return i+=e})),new ae("Error while calling `".concat(i,"`: ").concat(c.message),"functionEvalError",e,t,n,c)}}(e,o,n)}return t.stackDepth-=1,r}function un(e){if("string"===typeof e)return e;var t="";return e.print((function(e){return t+=e})),t}function dn(e,t,n,r,o){if("boolean"!==typeof e)throw new ae("Found operand `".concat(JSON.stringify(t),"` that is no boolean value. Boolean operators only work with values that are `true` or `false`."),"invalidOperandType",n,r,o)}function hn(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.knownLiteralsWithoutDollarSign;if(e.text.startsWith("$")){var a=$(e.name,t,n)||V(e.name,t);if(!a)throw new ae("Could not find a node with name `".concat(e.name,"`."),"nodeNotFound",e,t,n);if(a instanceof Array)return a.map((function(e){return pn(e,t,"calculation",t.nodesToAnswers.get(e))}));var i=pn(a,t,"calculation",t.nodesToAnswers.get(a));if(i.error)throw new ae("Error in expression ".concat(e.text,"."),"unsupportedNameExpression",e,t,n,i.error instanceof ae?i.error:void 0);return i.result}if(e.text===e.name){var c=t.evaluateNonDollarNameFn?t.evaluateNonDollarNameFn({expression:e,context:t,scope:n}):o[e.name];if(void 0!==c||r)return c;throw new ae("Unknown name `".concat(e.text,"` \u2014 did you mean to use `${").concat(e.name,"}` instead of `").concat(e.name,"`?"),"unknownNameWithoutDollarSign",e,t,n)}throw new ae("Don\u2019t know how to evaluate ".concat(e,"."),"unsupportedNameExpression",e,t,n)}function fn(e){if(!e)throw new le("Formula was not evaluated to an expression, but no error was encountered. This means an error handler is missing for this case.")}function bn(e,t){var n,r,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.survey,i=new be(e),c=new Pe({tokens:i});try{if(!(o=c.parseExpression()))throw new Error("Parsing given formula `".concat(e,"` returned an empty expression. This should not happen, it means the underlying code should have thrown an exception earlier."));return r=ln(o,t,a),fn(o),{parser:c,state:"success",expression:o,result:r,error:void 0}}catch(s){if(!(s instanceof oe))throw s;n=s}return{parser:c,state:"error",expression:o,error:n,result:null}}function pn(e,t,n,r){var o,a=null===(o=e.row)||void 0===o?void 0:o[n];if(void 0!==a&&"string"!==typeof a)throw new Error("Sorry, multilingual formulas are not supported yet.");var i=null===a||void 0===a?void 0:a.trim();if(""===i||void 0===i){var c=r,s="select_multiple"===e.type&&c instanceof Array?c.join(" "):c;return{state:"success",result:s,expression:new Ie([],s instanceof Array?"array":typeof s,s),error:void 0}}var l=e.row,u=void 0;try{u=bn(i,t,e)}catch(h){var d;throw new ae("Error in `".concat(n,"` column of the \u2018").concat(null===l||void 0===l?void 0:l.name,"\u2019 question (row #").concat(e.rowIndex,"). It contains the formula `").concat(null===l||void 0===l?void 0:l[n],"`. Please ensure the formula is valid. The error was: ").concat(h),"calculationError",null===(d=u)||void 0===d?void 0:d.expression,t,e,h)}return u}function jn(e,t,n){var r,o={relevant:!0,calculation:t.nodesToAnswers.get(e),required:!1,readonly:!1,constraint:!0};L.forEach((function(r){n(e,r,pn(e,t,r,o[r]))})),null===(r=e.children)||void 0===r||r.forEach((function(e){return jn(e,t,n)}))}function vn(e,t){jn(e.rootSurveyGroup,t,(function(e,n,r){var o,a=t.evaluationResults.get(e);a||(a=new Map,t.evaluationResults.set(e,a)),null===(o=a)||void 0===o||o.set(n,r)}))}function gn(e){var t=e.xlsForm,n=e.language,o=e.setXLSForm,a=Object(r.useState)(),i=Object(h.a)(a,2),s=i[0],l=i[1];Object(r.useEffect)((function(){l(t?function(e){if(e&&e.survey===t.rootSurveyGroup)return console.log("Context exists already and survey is the same, keeping context."),e;var n=x(t.rootSurveyGroup);return n.nodesToAnswers=new Map,n.survey=t.rootSurveyGroup,n.stackDepth=0,n.knownLiteralsWithoutDollarSign=O,vn(t,n),console.log("Setting up new evaluation context",n),n}:void 0)}),[t,null===t||void 0===t?void 0:t.rootSurveyGroup]);var d=r.useCallback((function(e,n){F.clear(),F.show({message:Object(B.jsxs)(B.Fragment,{children:[n.schemaKey," \u2192 ",Object(B.jsx)(p.g,{children:JSON.stringify(e)})]})}),t&&s&&l((function(r){if(r){var o=new Map(r.nodesToAnswers.entries());o.set(n.node,e);var a=Object(c.a)(Object(c.a)({},r),{},{nodesToAnswers:o});return vn(t,a),a}}))}),[s,t]),f=r.useCallback((function(e,r,a,i,c){t&&s&&n&&o(function(e){var t=e.worksheetName,n=e.xlsForm,r=e.rowIndex,o=e.node,a=e.context,i=e.language,c=e.columnName,s=e.value,l=o&&X(o,a),d=Jt.includes(c)?[c,i]:[c],h="survey"===t;return Object(Gt.a)(n,(function(e){Object(G.set)(e,["worksheets",t,"rows",r].concat(d),s),h&&(Object(G.set)(e,["flatNodes",r,"row"].concat(d),s),l&&Object(G.set)(e,["rootSurveyGroup"].concat(Object(u.a)(l.map((function(e){return["children",e]})).flat()),["row"],d),s))}))}({worksheetName:e,xlsForm:t,node:c,rowIndex:r,columnName:a,language:n,value:i,context:s}))}),[t,s,n,o]),b=r.useCallback((function(e,n,r){for(var a=arguments.length,i=new Array(a>3?a-3:0),l=3;l<a;l++)i[l-3]=arguments[l];t&&s&&o((function(t){var o,a,s=null===t||void 0===t?void 0:t.worksheets.survey;if(!s)throw new Error("No survey worksheet defined.");var l=null===t||void 0===t?void 0:t.worksheets[e];if(!l)return t;var d=Object(u.a)(null===l||void 0===l?void 0:l.rows);d.splice.apply(d,[n,r].concat(i));var h=Object(c.a)(Object(c.a)({},l),{},{rows:d});return nn("survey"===e?h:s,(null===t||void 0===t||null===(o=t.worksheets.settings)||void 0===o||null===(a=o.rows[0])||void 0===a?void 0:a.default_language)||"English (en)","settings"===e?h:null===t||void 0===t?void 0:t.worksheets.settings,"choices"===e?h:null===t||void 0===t?void 0:t.worksheets.choices)}))}),[s,o,t]),j=r.useCallback((function(e){if(t&&s){if(!X(e,s))throw new Error("Can\u2019t remove a node that isn\u2019t reachable from survey root. Please ensure the node is actually part of the survey.");var n=e.children.length>0?Xe(t,e)-e.rowIndex+1:1;b("survey",e.rowIndex,n)}}),[s,b,t]),v=r.useCallback((function(e){t&&s&&n&&o(Object(Gt.a)(t,(function(e){})))}),[]);return{context:s,setContext:l,onChangeAnswer:d,onChangeCell:f,onMoveNode:v,onSpliceRows:b,onRemoveRowAndChildren:j}}function mn(e){var t=e.setWorksheetName,n=e.worksheetName;return Object(B.jsx)(p.C.Group,{align:j.a.LEFT,children:Object(B.jsxs)(p.d,{children:[Object(B.jsx)(p.c,{onClick:function(){return t("survey")},active:"survey"===n,children:"Survey"}),Object(B.jsx)(p.c,{onClick:function(){return t("choices")},active:"choices"===n,children:"Choices"}),Object(B.jsx)(p.c,{onClick:function(){return t("settings")},active:"settings"===n,children:"Settings"})]})})}function On(e){return Object(B.jsx)("div",{props:e,style:Object(c.a)({margin:"".concat(e.horizontal,"rem ").concat(e.vertical,"rem")},e.style),children:e.children})}var xn=n(149);function yn(e){return Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsx)("h4",{children:"Object arrays are not implemented yet."})})}function wn(e){var t,n,o,a,i,s,l=r.useContext(y).onChangeCell,u=e.schema,d=e.schemaKey,h=e.node,f=u.objectKeys(d),b=r.useContext(y),j=b.debug,v=h===(null===(t=b.context)||void 0===t?void 0:t.survey)?null===(n=b.xlsForm)||void 0===n||null===(o=n.worksheets.settings)||void 0===o?void 0:o.rows[0].form_title:u.get(d,"label"),g=b.context&&K(h,b.context).join("/"),m=r.useCallback((function(e){e===v||void 0===v&&""===e||l("settings",0,"form_title",e)}),[l,v]),O=r.useCallback((function(e){e===v||void 0===v&&""===e||l("survey",h.rowIndex,"label",e,h)}),[h,l,v]),x=h===(null===(a=b.context)||void 0===a?void 0:a.survey)?Object(B.jsx)(p.l,{onChange:m,onConfirm:m,placeholder:"Enter a survey title\u2026",value:v,minWidth:100}):Object(B.jsx)(p.l,{multiline:!0,onChange:O,onConfirm:O,placeholder:"Enter a title for `".concat(h.row.name,"`\u2026"),value:v,minWidth:100}),w=[p.o,p.p,p.q,p.r,p.s][h.indentationLevel]||p.s,k="string"===typeof b.language&&(null===(i=h.row.hint)||void 0===i?void 0:i[b.language]);return R(h,b.context)||j?Object(B.jsxs)(p.i,{vertical:!0,style:{padding:"".concat(6/(h.indentationLevel+1),"rem 0")},children:[Object(B.jsxs)(p.i,{fill:!0,style:{alignItems:"baseline"},children:[Object(B.jsx)(w,{style:{flex:1},id:g,children:j?Object(B.jsx)(B.Fragment,{children:x}):v}),j&&h!==(null===(s=b.context)||void 0===s?void 0:s.survey)&&Object(B.jsx)(Lt,Object(c.a)(Object(c.a)({},Object(c.a)({},e)),{},{editable:!0}))]}),f.map((function(t){return Object(B.jsx)(Wn,{schemaKey:[d,t].join("."),relevant:e.relevant,readonly:e.readonly},t)})),k&&Object(B.jsx)(p.e,{intent:"primary",children:k})]}):null}var kn=[void 0,"","start","end","today","username","simserial","subscriberid","deviceid","phonenumber","calculate"];function En(e){var t=e.value,n=e.labelElement,r=e.relevant,o=e.readonly;return void 0!==t&&"boolean"!==typeof t?Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsxs)("h4",{children:["Value must be a ",Object(B.jsx)(p.g,{children:"boolean"})," for this field to work"]})}):Object(B.jsx)(p.f,{large:!0,disabled:!1===r||o,labelElement:n,onChange:e.onInputChange,defaultChecked:"boolean"===typeof e.defaultValue?e.defaultValue:void 0})}function Nn(e){var t=e.value,n=e.node,o=e.relevant,a=e.readonly,i=r.useContext(y),c=i.language,s=i.onChangeAnswer,l=void 0!==t&&"string"!==typeof t&&(!(t instanceof Array)||t.find((function(e){return"string"!==typeof e}))),u=r.useMemo((function(){return"string"===typeof t?new Set(""===t?[]:null===t||void 0===t?void 0:t.split(" ")):t instanceof Array||t instanceof Set?new Set(t):new Set}),[t]),d=r.useCallback((function(t){var n=t.currentTarget.name,r=new Set(u);t.currentTarget.checked?r.add(n):r.delete(n),s(Array.from(r),e)}),[e,s,u]);return"string"!==typeof c?null:l?Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsxs)("h4",{children:["Value must be a ",Object(B.jsx)(p.g,{children:"string"})," or Array of ",Object(B.jsx)(p.g,{children:"string"}),"s for this field to work."]})}):i.debug&&0===n.typeParameters.length?Object(B.jsx)(p.e,{intent:"warning",title:"No choice list set.",children:Object(B.jsx)(Et,{node:n,showType:!1})}):Object(B.jsx)(p.i,{vertical:!0,children:n.typeParameters.map((function(e){var t,n=null===(t=i.xlsForm)||void 0===t?void 0:t.choicesByName[e];return n?Object.keys(n).map((function(e){var t,r=n[e],i=null===r||void 0===r||null===(t=r.label)||void 0===t?void 0:t[c],s="undefined"===i?null===r||void 0===r?void 0:r.name:i;return Object(B.jsx)(p.f,{disabled:!1===o||a,label:s,checked:"string"===typeof e&&u.has(e),name:e,inline:!0,large:!0,onChange:d})})):null}))})}var Tn=n(402),Sn={formatDate:function(e){return e.toLocaleDateString()},parseDate:function(e){return e.length?new Date(e):null},placeholder:"YYYY-MM-DD"};function An(e){var t=e.value,n=e.relevant,o=e.readonly,a=r.useContext(y).onChangeAnswer,i=r.useCallback((function(t,n){n&&a(t,e)}),[e,a]);if(void 0!==t&&!(t instanceof Date))return Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsxs)("h4",{children:["Value must be a ",Object(B.jsx)(p.g,{children:"Date"})," for this field to work"]})});var s=void 0;return"string"===typeof e.defaultValue?s=Sn.parseDate(e.defaultValue):e.defaultValue instanceof Date&&(s=e.defaultValue),Object(B.jsx)(Tn.a,Object(c.a)(Object(c.a)({},Sn),{},{onChange:i,defaultValue:s||void 0,disabled:!1===n||o}))}function Cn(e){var t,n=e.schema,o=e.schemaKey,a=e.node,i=e.debug,c=e.relevant,s=e.isEditable,l=e.children,u=r.useContext(y),d=null===(t=a.row.label)||void 0===t?void 0:t[u.language||"English (en)"],f=n.get(o,"label"),b=r.useContext(y).onChangeCell,j=u.context&&K(a,u.context).join("/"),v=r.useState(d),g=Object(h.a)(v,2),m=g[0],O=g[1],x=r.useCallback((function(e){O(e)}),[]);r.useEffect((function(){O(d)}),[d]);var w=r.useCallback((function(e){e===d||void 0===d&&""===e||b("survey",a.rowIndex,"label",e,a)}),[a,b,d]),k=s&&i?Object(B.jsx)(p.l,{onChange:x,onConfirm:w,placeholder:"Enter a title for `".concat(a.row.name,"`\u2026"),value:m,minWidth:100,minLines:1,maxLines:5,multiline:!0}):f;return l?Object(B.jsxs)(p.i,{style:{alignItems:"center"},lang:u.languageCode,children:[Object(B.jsx)("span",{id:j,className:c?"":E.a.TEXT_DISABLED,style:{flex:1},children:i?k:Object(B.jsx)(ut,{children:f})}),l]}):Object(B.jsx)("span",{id:j,className:c?"":E.a.TEXT_DISABLED,style:{flex:1},lang:u.languageCode,children:i?k:Object(B.jsx)(ut,{children:f})})}function Ln(e){var t=e.value,n=e.schemaKey,o=e.relevant,a=e.readonly,i=r.useContext(y).onChangeAnswer,c=r.useCallback((function(t){i(t,e)}),[e,i]);return void 0!==t&&"string"!==typeof t&&"number"!==typeof t?Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsxs)("h4",{children:["Value must be a ",Object(B.jsx)(p.g,{children:"number"})," for this field to work."]})}):Object(B.jsx)(p.E,{id:n,disabled:!1===o||a,name:n,large:!0,allowNumericCharactersOnly:!1,placeholder:"Enter a number\u2026",value:t,onValueChange:c,defaultValue:"number"===typeof e.defaultValue||"string"===typeof e.defaultValue?e.defaultValue:void 0})}var Rn,In,_n,Dn,Mn,Pn=n(12);function Fn(e){var t=e.value,n=e.onInputChange,o=e.allowedValues,a=e.node,i=e.relevant,c=e.readonly,s=r.useContext(y),l=s.language;return void 0!==t&&"string"!==typeof t?Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsxs)("h4",{children:["Value must be a ",Object(B.jsx)(p.g,{children:"string"})," for this field to work"]})}):void 0===l?null:s.debug&&0===a.typeParameters.length?Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsxs)(p.i,{fill:!0,children:[Object(B.jsx)(p.r,{children:"No choice list set."}),Object(B.jsx)("div",{className:Pn.FLEX_EXPANDER}),Object(B.jsx)(Et,{node:a,showType:!1})]})}):Object(B.jsx)(p.I,{onChange:n,selectedValue:t,inline:!0,disabled:!1===i||c,children:o.map((function(e){var t,n,r,o=a.typeParameters[0],i=null===(t=s.xlsForm)||void 0===t||null===(n=t.choicesByName[o])||void 0===n?void 0:n[e],c=null===i||void 0===i||null===(r=i.label)||void 0===r?void 0:r[l],u="undefined"===c?null===i||void 0===i?void 0:i.name:c;return Object(B.jsx)(p.H,{label:u,value:null===i||void 0===i?void 0:i.name,inline:!0,large:!0})}))})}function Bn(e){var t=e.value,n=e.schemaKey,r=e.relevant,o=e.readonly;return void 0!==t&&"string"!==typeof t&&"number"!==typeof t?Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsxs)("h4",{children:["Value must be a ",Object(B.jsx)(p.g,{children:"string"})," or ",Object(B.jsx)(p.g,{children:"number"})," for this field to work."]})}):Object(B.jsx)(p.y,{id:n,disabled:!1===r||o,name:n,placeholder:"",large:!0,onChange:e.onInputChange,defaultValue:"string"===typeof e.defaultValue?e.defaultValue:void 0})}function Un(e){var t=e.quickType,n=e.schema,r=e.schemaKey;if("number"===t)return Object(B.jsx)(Ln,Object(c.a)({},e));if("date"===t)return Object(B.jsx)(An,Object(c.a)({},e));if("boolean"===t)return Object(B.jsx)(En,Object(c.a)({},e));if("stringArray"===t){var o=n.get(r+".$","allowedValues");if(o instanceof Array)return Object(B.jsx)(Nn,Object(c.a)({},Object(c.a)(Object(c.a)({},e),{},{allowedValues:o})))}var a=n.get(r,"allowedValues");return a instanceof Array?Object(B.jsx)(Fn,Object(c.a)({},Object(c.a)(Object(c.a)({},e),{},{allowedValues:a}))):Object(B.jsx)(Bn,Object(c.a)({},e))}function Gn(e){var t,n,o=e.node,a="boolean"===e.quickType,i=r.useContext(y),s=i.language,l=i.debug,u=i.context,d=i.onChangeAnswer,h=r.useCallback((function(t){var n=t.currentTarget,r={checkbox:n.checked,date:n.valueAsDate,number:n.valueAsNumber,text:n.value,radio:n.value}[n.type];d(r,e)}),[d,e]);if(!s||!u)return null;var f=kn.includes(o.type);if(f&&!i.debug)return null;var b=Object(B.jsx)(Lt,Object(c.a)(Object(c.a)({},Object(c.a)({},e)),{},{editable:!0})),j=(null===(t=o.row.hint)||void 0===t?void 0:t[s])&&Object(B.jsx)(p.e,{intent:"primary",children:null===(n=o.row.hint)||void 0===n?void 0:n[s]}),v=Object(B.jsx)(Cn,Object(c.a)(Object(c.a)({},Object(c.a)(Object(c.a)({},e),{},{debug:l,isEditable:!a&&!f})),{},{children:"boolean"!==e.quickType&&l&&b})),g=pn(o,u,"calculation",u.nodesToAnswers.get(o)),m=Object(c.a)(Object(c.a)({},e),{},{labelElement:v,onInputChange:h,value:g.result,defaultValue:o.row.default}),O=Object(B.jsx)(Un,Object(c.a)({},m));return a?Object(B.jsxs)(p.n,{labelFor:o.row.name,style:{display:"flex"},children:[l&&b,O,j]}):"note"===o.type?v:Object(B.jsxs)(p.n,{label:v,labelFor:o.row.name,children:[O,j]})}var Vn=v.a.div(Rn||(Rn=Object(f.a)(['\n  &:after {\n    content: "";\n    position: absolute;\n    left: 0px;\n    width: 1px;\n    bottom: 0;\n    top: 0;\n    background-color: transparent;\n  }\n']))),$n=v.a.div(In||(In=Object(f.a)(["\n  position: absolute;\n  left: 0px;\n  height: 44px;\n  width: 44px;\n  background-color: transparent;\n  cursor: pointer;\n"]))),zn=Object(v.a)($n)(_n||(_n=Object(f.a)(["\n  top: 0;\n  &:hover {\n    background: linear-gradient(\n      135deg,\n      ",",\n      "," 50%\n    );\n  }\n"])),ht(k.a.BLUE3,.1),ht(k.a.BLUE3,0)),Hn=Object(v.a)($n)(Dn||(Dn=Object(f.a)(["\n  bottom: 0;\n  &:hover {\n    background: linear-gradient(\n      45deg,\n      ",",\n      "," 50%\n    );\n  }\n"])),ht(k.a.BLUE3,.1),ht(k.a.BLUE3,0)),Kn=v.a.div(Mn||(Mn=Object(f.a)(["\n  padding: 16px 16px 8px;\n  margin: 0;\n  position: relative;\n\n  &:not(:hover):not(:focus-within) {\n    "," {\n      background: none;\n    }\n  }\n  &:hover,\n  :focus-within {\n    /* background: linear-gradient(\n      ",",\n      "," 20%,\n      ","\n    ); */\n    background: ",";\n\n    "," {\n      &:after {\n        background: ",";\n      }\n    }\n  }\n"])),Vn,ht(k.a.BLUE3,.1),ht(k.a.BLUE3,.03),ht(k.a.BLUE3,.03),ht(k.a.BLUE3,.03),Vn,ht(k.a.BLUE3,.1));function Wn(e){var t=e.schemaKey,n=r.useContext(y),o=n.schema,a=n.context,i=n.debug,s=U(),l=s.alert,d=s.showRemoveConfirmationDialog;if(!a||!o)return null;var h=o.getQuickTypeForKey(t),f=["."].concat(Object(u.a)(t.replace(/\.\$/g,"").split("."))),b=z(f,a,a.survey);if(b instanceof Array)return i?Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsxs)(p.r,{children:["Found multiple nodes with path ",Object(B.jsx)(p.g,{children:f.join("/")}),". This should not happen."]})}):null;if(!b)return i?Object(B.jsx)(p.e,{intent:"warning",children:Object(B.jsxs)(p.r,{children:["No node found for"," ",Object(B.jsx)(p.g,{children:f[f.length-1]})]})}):null;var j=e.relevant;if("boolean"!==typeof j||!0===j){var v,g=null===(v=a.evaluationResults.get(b))||void 0===v?void 0:v.get("relevant");j="boolean"===typeof(null===g||void 0===g?void 0:g.result)?g.result:null!==(null===g||void 0===g?void 0:g.result)}var m=!1;if("undefined"!==typeof e.readonly||!0===e.readonly){var O,x=null===(O=a.evaluationResults.get(b))||void 0===O?void 0:O.get("readonly");m="boolean"===typeof(null===x||void 0===x?void 0:x.result)?x.result:e.readonly}var k,T={schema:o,node:b,schemaKey:t,quickType:h,relevant:j,readonly:m};if(!i&&!j)return null;switch(h){case"object":k=Object(B.jsx)(wn,Object(c.a)({},T));break;case"objectArray":k=Object(B.jsx)(yn,Object(c.a)({},T));break;default:k=Object(B.jsx)(Gn,Object(c.a)({},T))}return i&&b!==a.survey?Object(B.jsxs)(B.Fragment,{children:[l,Object(B.jsx)(xn.a,{content:Object(B.jsx)(Ze,{node:b,onRemove:d}),children:Object(B.jsxs)(Kn,{children:[Object(B.jsx)(Vn,{}),Object(B.jsx)(N.a,{content:Object(B.jsx)("ul",{className:E.a.LIST_UNSTYLED,children:Object(B.jsx)(Ye,{icon:"arrow-up",node:b,position:"before"})}),lazy:!0,interactionKind:"click",placement:"left",renderTarget:function(e){e.isOpen;var t=e.ref,n=Object(w.a)(e,["isOpen","ref"]);return Object(B.jsx)(zn,Object(c.a)(Object(c.a)({},n),{},{ref:t}))},hoverOpenDelay:0,hoverCloseDelay:0}),Object(B.jsx)(N.a,{content:Object(B.jsx)("ul",{className:E.a.LIST_UNSTYLED,children:Object(B.jsx)(Ye,{icon:"arrow-down",node:b,position:"after"})}),lazy:!0,interactionKind:"click",placement:"left",renderTarget:function(e){e.isOpen;var t=e.ref,n=Object(w.a)(e,["isOpen","ref"]);return Object(B.jsx)(Hn,Object(c.a)(Object(c.a)({},n),{},{ref:t}))},hoverOpenDelay:0,hoverCloseDelay:0}),k]})})]}):k}var qn,Xn=n(401),Jn=n(399),Qn=n(158),Yn=Object(v.a)(Xn.a)(qn||(qn=Object(f.a)(["\n  /* flex: 1; */\n"])));function Zn(e){var t=e.language,n=e.xlsForm,o=e.worksheetName,a=r.useContext(y).onChangeCell,i=n.worksheets[e.worksheetName],s=null===i||void 0===i?void 0:i.rows.length,l=r.useMemo((function(){return Object(G.uniq)(null===i||void 0===i?void 0:i.columnNamesNormalized.map((function(e){return e.replace(/::.*$/,"")})))}),[n,i]),u=r.useCallback((function(e,t,r){if(void 0!==r&&void 0!==t){var c=null===i||void 0===i?void 0:i.rows[t];if(!c)throw new Error("Tried to change a row that doesn\u2019t exist");var s=l[r];c[s]!==e&&a(o,t,s,e,n.flatNodes[t])}}),[l,a,null===i||void 0===i?void 0:i.rows,o,n.flatNodes]),d=r.useMemo((function(){return function(e,r){var o=null===i||void 0===i?void 0:i.rows[e];if(!o)return Object(B.jsx)(B.Fragment,{});var a=l[r],c=o[a],s=n.flatNodes[e];return void 0!==c&&"string"!==typeof c?Jt.includes(a)?Object(B.jsx)(Jn.a,{rowIndex:e,columnIndex:r,onConfirm:u,value:c[t]}):Object(B.jsx)(Jn.a,{rowIndex:e,columnIndex:r,onConfirm:u,value:JSON.stringify(c)}):Object(B.jsx)(Jn.a,{rowIndex:e,columnIndex:r,onConfirm:u,value:c,style:["type","name"].includes(a)?{paddingLeft:"".concat(4+8*(null===s||void 0===s?void 0:s.indentationLevel),"px")}:{},children:c})}}),[null===i||void 0===i?void 0:i.rows,l,n.flatNodes,u,t]);return i?Object(B.jsx)(Ut,{style:Object(c.a)({},e.style),children:Object(B.jsx)(Yn,{numRows:s,enableRowResizing:!1,children:l.map((function(e){return Object(B.jsx)(Qn.a,{name:e,cellRenderer:d})}))})}):Object(B.jsxs)(p.e,{intent:"warning",children:["No ",e.worksheetName," sheet defined"]})}function er(e,t){return function(){return void 0!==e.row.relevant&&""!==e.row.relevant&&!bn(e.row.relevant,t,e)||!(void 0===e.row.required||""===e.row.required||bn(e.row.required,t,e))}}function tr(e,t,n){return!!e.match(/\${([^}]+)}/)?function(){return e.replaceAll(/\${([^}]+)}/g,(function(e,r,o){try{var a=e,i=ln(new ge([{type:Y.NAME,text:a,index:o}],r,e),t,n);return String(i)}catch(c){if(c instanceof oe)return c.toMarkdown();throw c}}))}:e}var nr=function(e,t){var n;return n={},Object($t.a)(n,e,Object(c.a)({type:Object},t)),Object($t.a)(n,"".concat(e,".maxValue"),{type:Number,optional:!0}),Object($t.a)(n,"".concat(e,".minValue"),{type:Number,optional:!0}),Object($t.a)(n,"".concat(e,".unitCode"),{type:Text,optional:!0}),Object($t.a)(n,"".concat(e,".unitText"),{type:Text,optional:!0}),Object($t.a)(n,"".concat(e,".value"),{type:m.a.oneOf(Number,String,Boolean)}),n},rr=function(e,t){var n;return Object(c.a)(Object(c.a)((n={},Object($t.a)(n,e,Object(c.a)({type:Object},t)),Object($t.a)(n,"".concat(e,".bitrate"),{type:String,label:"The bitrate of the media object.",optional:!0}),Object($t.a)(n,"".concat(e,".contentSize"),{type:String,label:"File size in (mega/kilo) bytes."}),Object($t.a)(n,"".concat(e,".contentUrl"),{type:String,regEx:m.a.RegEx.Url,label:"Actual bytes of the media object, for example the image file or video file."}),Object($t.a)(n,"".concat(e,".duration"),{type:String,label:"The duration of the item (movie, audio recording, event, etc.) in ISO 8601 date format.",optional:!0}),Object($t.a)(n,"".concat(e,".embedUrl"),{type:String,regEx:m.a.RegEx.Url,label:"A URL pointing to a player for a specific video. In general, this is the information in the src element of an embed tag and should not be the same as the content of the loc tag.",optional:!0}),Object($t.a)(n,"".concat(e,".encodingFormat"),{type:String,label:"Media type typically expressed using a MIME format (see IANA site and MDN reference) e.g. application/zip for a SoftwareApplication binary, audio/mpeg for .mp3 etc.)."}),Object($t.a)(n,"".concat(e,".endTime"),{type:Date,label:"the time offset of the end of a clip within a larger file.",optional:!0}),Object($t.a)(n,"".concat(e,".startTime"),{type:Date,label:"the time offset of the start of a clip within a larger file.",optional:!0}),Object($t.a)(n,"".concat(e,".uploadDate"),{type:Date,label:"Date when this media object was uploaded to this site.",optional:!0}),n),nr("".concat(e,".height"),{type:m.a.oneOf(String,Object),label:"The height of the item."})),nr("".concat(e,".width"),{type:m.a.oneOf(String,Object),label:"The width of the item."}))},or=function e(t){var n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2?arguments[2]:void 0;return Object(c.a)(Object(c.a)((n={},Object($t.a)(n,t,Object(c.a)({type:Object},o)),Object($t.a)(n,"".concat(t,".exifData"),{type:Object,blackbox:!0,label:" or Text\texif data for this object.",optional:!0}),Object($t.a)(n,"".concat(t,".representativeOfPage"),{type:Boolean,label:"Indicates whether this image is representative of the content of the page.",optional:!0}),n),rr("".concat(t,".caption"),{label:"The caption for this object. For downloadable machine formats (closed caption, subtitles etc.) use MediaObject and indicate the encodingFormat.",optional:!0})),r?e("".concat(t,".thumbnail"),!1,{label:"Thumbnail image for an image or video.",optional:!0}):{})};function ar(e){var t,n=e.node.typeParameters,r=Object.keys(e.xlsForm.choicesByName),o=e.node.row.type;if(!(void 0!==r[0]))throw new le("Node `".concat(e.key,"` uses `").concat(o,"` as its `type`, but the \u2018choices\u2019 worksheet seems to be empty or invalid. Please define some valid choice lists first."));var a=e.xlsForm.choicesByName,i=Object(G.compact)(n.map((function(t){return t.trim().startsWith("$")?function(e,t,n){var r=bn(e,t.context,t.node);if("error"===r.state)throw new ae("Error evaluating `".concat(e,"` to determine available selection choices."),"invalidDynamicChoices",r.expression,t.context,t.node);if("string"!==typeof r.result)throw new ae("Evaluating `".concat(e,"` did not yield a `string`. Please ensure the referenced field returns a string."),"invalidDynamicChoices",r.expression,t.context,t.node);var o=r.result;if(!n[o])throw new ae("Evaluating `".concat(e,"` yielded string `'").concat(o,"'`, but the according choices list does not exist. Please ensure that the field calculates an existing list name."),"invalidDynamicChoices",r.expression,t.context,t.node);return o}(t,e,a):t}))).filter((function(e){return void 0!==e&&""!==e})),s=i.map((function(e){return a[e]})).filter((function(e){return void 0!==e}));if(s.length!==i.length)throw new le("Node `".concat(e.key,"` (row #").concat(e.node.rowIndex+2,") refers to list names `").concat(i,"`. One of these lists is either not defined in the \u2018choices\u2019 worksheet, or could not be loaded correctly. Found list names:\n\n").concat(r.map((function(e){return"`".concat(e,"`")})).join(", ")));var l=null===(t=e.node.row.choice_filter)||void 0===t?void 0:t.trim();return l&&""!==l?function(e,t,n,r){var o=new be(e),a=new Pe({tokens:o}).parseExpression();return function(){return t.flatMap((function(e){return Object.values(e)})).filter((function(e){var t=ln(a,Object(c.a)(Object(c.a)({},r),{},{evaluateNonDollarNameFn:function(t){return e[t.expression.name]||O[t.expression.name]}}),n);if("boolean"!==typeof t)throw new ae("`choice_filter` formula did not evaluate to a `boolean`. Please ensure the formula returns a `boolean`.","invalidDynamicChoices",a,r,n);return t})).map((function(e){return e.name}))}}(l,s,e.node,e.context):s.flatMap((function(e){return Object.keys(e)}))}var ir,cr,sr={"":function(){return{}},integer:function(e){return Object($t.a)({},e.key,{type:m.a.Integer})},decimal:function(e){return Object($t.a)({},e.key,{type:Number})},range:function(e){return Object($t.a)({},e.key,{type:Number})},text:function(e){return Object($t.a)({},e.key,{type:String})},select_one:function(e){return Object($t.a)({},e.key,{type:String,allowedValues:ar(e)})},select_multiple:function(e){var t;return t={},Object($t.a)(t,e.key,{type:Array}),Object($t.a)(t,e.key+".$",{type:String,allowedValues:ar(e)}),t},select_one_from_file:function(e){return Object($t.a)({},e.key,{type:String})},select_multiple_from_file:function(e){var t;return t={},Object($t.a)(t,e.key,{type:Array}),Object($t.a)(t,e.key+".$",{type:String}),t},rank:function(e){return Object($t.a)({},e.key,{type:String})},note:function(e){return Object($t.a)({},e.key,{type:String})},geopoint:function(e){return function(e){var t;return t={},Object($t.a)(t,e,{type:Object}),Object($t.a)(t,"".concat(e,".type"),{type:String,allowedValues:["Point"],defaultValue:"Point"}),Object($t.a)(t,"".concat(e,".coordinates"),{type:Array,minCount:2,maxCount:2}),Object($t.a)(t,"".concat(e,".coordinates.$"),{type:Number,min:-180,max:180}),t}(e.key)},geotrace:function(e){return function(e){var t;return t={},Object($t.a)(t,e,{type:Object}),Object($t.a)(t,"".concat(e,".type"),{type:String,allowedValues:["LineString"],defaultValue:"LineString"}),Object($t.a)(t,"".concat(e,".coordinates"),{type:Array,minCount:2}),Object($t.a)(t,"".concat(e,".coordinates.$"),{type:Array,minCount:2,maxCount:2}),Object($t.a)(t,"".concat(e,".coordinates.$.$"),{type:Number,min:-180,max:180}),t}(e.key)},geoshape:function(e){return function(e){var t;return t={},Object($t.a)(t,e,{type:Object}),Object($t.a)(t,"type",{type:String,allowedValues:["Polygon"],defaultValue:"Polygon"}),Object($t.a)(t,"".concat(e,".coordinates"),{type:Array,minCount:1}),Object($t.a)(t,"".concat(e,".coordinates.$"),{type:Array,minCount:2}),Object($t.a)(t,"".concat(e,".coordinates.$.$"),{type:Array,minCount:4,maxCount:4}),Object($t.a)(t,"".concat(e,".coordinates.$.$.$"),{type:Number,min:-180,max:180}),t}(e.key)},date:function(e){return Object($t.a)({},e.key,{type:Date})},time:function(e){return Object($t.a)({},e.key,{type:Date})},datetime:function(e){return Object($t.a)({},e.key,{type:Date})},image:function(e){return or(e.key)},audio:function(e){return function(e,t){var n;return Object(c.a)((n={},Object($t.a)(n,e,Object(c.a)({type:Object},t)),Object($t.a)(n,"".concat(e,".transcript"),{type:String,optional:!0}),n),rr("".concat(e,".caption"),{type:m.a.oneOf(String,Object),label:"The caption for this object. For downloadable machine formats (closed caption, subtitles etc.) use MediaObject and indicate the encodingFormat.",optional:!0}))}(e.key)},video:function(e){return function(e,t){var n;return Object(c.a)((n={},Object($t.a)(n,e,Object(c.a)({type:Object},t)),Object($t.a)(n,"".concat(e,".caption"),{type:rr("".concat(e,".caption")),label:" or Text\tThe caption for this object. For downloadable machine formats (closed caption, subtitles etc.) use MediaObject and indicate the encodingFormat.",optional:!0}),Object($t.a)(n,"".concat(e,".transcript"),{type:String,label:"If this MediaObject is an AudioObject or VideoObject, the transcript of that object.",optional:!0}),Object($t.a)(n,"".concat(e,".videoFrameSize"),{type:String,label:"The frame size of the video.",optional:!0}),Object($t.a)(n,"".concat(e,".videoQuality"),{type:String,optional:!0}),n),or("".concat(e,".thumbnail"),!0,{label:"Thumbnail image for an image or video.",optional:!0}))}(e.key)},file:function(e){return rr(e.key)},barcode:function(e){return Object($t.a)({},e.key,{type:String})},calculate:function(e){return Object($t.a)({},e.key,{type:String})},acknowledge:function(e){return Object($t.a)({},e.key,{type:Boolean})},hidden:function(e){return Object($t.a)({},e.key,{type:String})},"xml-external":function(e){return Object($t.a)({},e.key,{type:String})},start:function(e){return Object($t.a)({},e.key,{type:Date})},end:function(e){return Object($t.a)({},e.key,{type:Date})},today:function(e){return Object($t.a)({},e.key,{type:Date})},deviceid:function(e){return Object($t.a)({},e.key,{type:String})},simserial:function(e){return Object($t.a)({},e.key,{type:String})},subscriberid:function(e){return Object($t.a)({},e.key,{type:String})},phonenumber:function(e){return Object($t.a)({},e.key,{type:String})},username:function(e){return Object($t.a)({},e.key,{type:String})},email:function(e){return Object($t.a)({},e.key,{type:String,regEx:m.a.RegEx.EmailWithTLD})},audit:function(e){return Object($t.a)({},e.key,{type:String})}};function lr(e){var t,n,r,o=e.node,a=e.language,i=e.xlsForm,s=e.context,l=e.key,d={label:tr((null===(t=o.row.label)||void 0===t?void 0:t[a])||"",s,o),optional:er(o,s)};if(null===(n=o.row)||void 0===n?void 0:n.type.match(/^begin_repeat$/)){var h=o.children.map((function(t){return lr(Object(c.a)(Object(c.a)({},e),{},{node:t,key:l+".$."+t.row.name}))}));r=Object.assign.apply(Object,[Object($t.a)({},l,Object(c.a)(Object(c.a)({},d),{},{type:Array}))].concat(Object(u.a)(h)))}else if(o.row.type.match(/^begin_group$/)||o===i.rootSurveyGroup){var f=o.children.map((function(t){return t.row,lr(Object(c.a)(Object(c.a)({},e),{},{node:t,key:l+"."+t.row.name}))}));r=Object.assign.apply(Object,[Object($t.a)({},l,Object(c.a)(Object(c.a)({},d),{},{type:Object}))].concat(Object(u.a)(f)))}else r=function(e,t,n,r,o){var a,i=e.row;if(!i)throw new Error("Node needs an associated row for creating a schema.");var s=(null===(a=i.label)||void 0===a?void 0:a[t])||"",l={type:String,label:tr(s,r,e),optional:er(e,r)},u=sr[e.type];if(!u)throw new Error("Could not find schema generator for node type ".concat(JSON.stringify(i)));var d=u({key:o,node:e,xlsForm:n,context:r}),h=d[Object.keys(d)[0]];return Object.assign(h,l,Object(c.a)({},h)),d}(o,a,i,s,l);return r}b.a.onlyShowFocusOnTabs();var ur=Object(v.a)((function(e){var t=r.useContext(y),n=t.schema,o=t.languageCode,a=t.debug,i=null===n||void 0===n?void 0:n.objectKeys().map((function(e){return Object(B.jsx)(Wn,{schemaKey:e},e)}));return Object(B.jsx)(On,{horizontal:2,vertical:2,className:e.className,style:{maxWidth:a?"60rem":"50rem",padding:"4rem",margin:"auto"},lang:o,children:Object(B.jsx)("form",{children:i})})}))(ir||(ir=Object(f.a)(["\n  max-width: 800px;\n  margin: auto;\n\n  font-size: 20px;\n  .bp3-small {\n    font-size: 16px;\n  }\n\n  .bp3-large {\n    font-size: 20px;\n  }\n\n  .bp3-form-helper-text {\n    font-size: 16px;\n  }\n\n  .bp3-form-group {\n    margin: 0 0 40px;\n  }\n\n  .bp3-control {\n    margin-bottom: 10px;\n  }\n"]))),dr=v.a.div(cr||(cr=Object(f.a)(["\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n"])));function hr(e){return Object(B.jsx)(p.K,{checked:e.checked,label:e.label,onChange:e.onChange,inline:!0,style:{marginBottom:"0"}})}var fr=function(){var e=o.a.useState(),t=Object(h.a)(e,2),n=t[0],r=t[1],a=o.a.useState(),i=Object(h.a)(a,2),s=i[0],f=i[1],b=o.a.useState(!0),v=Object(h.a)(b,2),g=v[0],O=v[1],x=o.a.useState(!1),w=Object(h.a)(x,2),k=w[0],E=w[1],N=o.a.useState(!1),T=Object(h.a)(N,2),S=T[0],A=T[1],C=o.a.useState("survey"),L=Object(h.a)(C,2),R=L[0],I=L[1],_=o.a.useCallback(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,o,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yt(t);case 2:a=e.sent,r(a),f((null===(n=a.worksheets.settings)||void 0===n?void 0:n.rows[0].default_language)||Object(u.a)(null===(o=a.languages)||void 0===o?void 0:o.values())[0]||"English (en)");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),D=o.a.useCallback((function(e){O(!e.currentTarget.checked)}),[]),M=o.a.useCallback((function(e){E(e.currentTarget.checked)}),[]),P=o.a.useCallback((function(e){A(e.currentTarget.checked)}),[]),F=Object(B.jsx)(Mt,{onLoadWorkbook:_}),U=o.a.useCallback((function(){r(void 0)}),[]),G=Object(B.jsx)(p.c,{className:"bp3-minimal",icon:"reset",text:"Reset",onClick:U}),V=n&&Object(B.jsx)(Ut,{className:"bp3-code-block",style:{padding:"1rem",margin:"0",whiteSpace:"pre"},children:Object(B.jsx)(_t,{xlsForm:n})}),$=gn({language:s,xlsForm:n,setXLSForm:r}),z=$.context,H=(null===s||void 0===s?void 0:s.match(/^(.*) \((\w+)\)$/))||[],K=Object(h.a)(H,3),W=K[1],q=K[2],X=o.a.useMemo((function(){if(n&&s&&z)return function(e,t,n){var r=lr({node:e.rootSurveyGroup,xlsForm:e,context:t,language:n,key:e.rootSurveyGroup.row.name});return new m.a(new m.a(r).mergedSchema())}(n,z,s)}),[n,s,z]);return Object(B.jsx)(We.Provider,{value:{onDropNode:$.onMoveNode},children:Object(B.jsxs)(y.Provider,{value:Object(c.a)({schema:X,language:s,languageCode:q,languageName:W,debug:g,xlsForm:n},$),children:[n&&Object(B.jsxs)(p.C,{children:[k&&Object(B.jsx)(mn,{setWorksheetName:I,worksheetName:R}),Object(B.jsxs)(p.C.Group,{align:j.a.RIGHT,children:[G,Object(B.jsx)(p.C.Divider,{}),Object(B.jsx)(hr,{checked:!0===k,label:"Table",onChange:M}),Object(B.jsx)(hr,{checked:!1===g,label:"Live View",onChange:D}),Object(B.jsx)(hr,{checked:!0===S,label:"JSON",onChange:P}),Object(B.jsx)(p.C.Divider,{}),n&&s&&Object(B.jsx)(Bt,{languages:Array.from(n.languages.values()),language:s,onChange:f})]})]}),Object(B.jsxs)(dr,{children:[!n&&Object(B.jsx)(Ut,{children:Object(B.jsx)(p.D,{icon:"document-open",title:"Open an Excel file to start.",action:F})}),n&&s&&k&&Object(B.jsx)(Zn,{xlsForm:n,language:s,debug:g,style:{width:"50%"},worksheetName:R}),n&&s&&Object(B.jsx)(Ut,{style:{boxShadow:"0 0px 30px #9fb7c2",zIndex:1},children:Object(B.jsx)(ur,{xlsForm:n,language:s,debug:g})}),n&&s&&S&&V]})]})})},br=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,405)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),o(e),a(e),i(e)}))};Object(Gt.b)(),Object(Gt.c)(),i.a.render(Object(B.jsx)(o.a.StrictMode,{children:Object(B.jsx)(fr,{})}),document.getElementById("root")),br()}},[[382,1,2]]]);
//# sourceMappingURL=main.fea8b1b1.chunk.js.map